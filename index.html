
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Build workflows for your Relays">
      
      
      
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.2.8">
    
    
      
        <title>relay-py</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.046329b4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#build-workflows-for-your-relays" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="relay-py" class="md-header__button md-logo" aria-label="relay-py" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            relay-py
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Build workflows for your Relays
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/relaypro/relay-py" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    relaypro/relay-py
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="relay-py" class="md-nav__button md-logo" aria-label="relay-py" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    relay-py
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/relaypro/relay-py" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    relaypro/relay-py
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Build workflows for your Relays
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Build workflows for your Relays
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#relay.workflow" class="md-nav__link">
    workflow
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.Relay" class="md-nav__link">
    Relay
  </a>
  
    <nav class="md-nav" aria-label="Relay">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.alert" class="md-nav__link">
    alert()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.answer_call" class="md-nav__link">
    answer_call()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.breathe" class="md-nav__link">
    breathe()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.broadcast" class="md-nav__link">
    broadcast()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.cancel_alert" class="md-nav__link">
    cancel_alert()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.cancel_broadcast" class="md-nav__link">
    cancel_broadcast()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.clear_timer" class="md-nav__link">
    clear_timer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.create_incident" class="md-nav__link">
    create_incident()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.disable_location" class="md-nav__link">
    disable_location()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.enable_location" class="md-nav__link">
    enable_location()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.end_interaction" class="md-nav__link">
    end_interaction()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.flash" class="md-nav__link">
    flash()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.get_device_address" class="md-nav__link">
    get_device_address()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.get_device_battery" class="md-nav__link">
    get_device_battery()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.get_device_coordinates" class="md-nav__link">
    get_device_coordinates()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.get_device_id" class="md-nav__link">
    get_device_id()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.get_device_indoor_location" class="md-nav__link">
    get_device_indoor_location()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.get_device_latlong" class="md-nav__link">
    get_device_latlong()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.get_device_location" class="md-nav__link">
    get_device_location()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.get_device_location_enabled" class="md-nav__link">
    get_device_location_enabled()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.get_device_name" class="md-nav__link">
    get_device_name()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.get_device_type" class="md-nav__link">
    get_device_type()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.get_group_members" class="md-nav__link">
    get_group_members()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.get_number_var" class="md-nav__link">
    get_number_var()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.get_source_uri_from_trigger" class="md-nav__link">
    get_source_uri_from_trigger()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.get_unread_inbox_size" class="md-nav__link">
    get_unread_inbox_size()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.get_user_profile" class="md-nav__link">
    get_user_profile()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.get_var" class="md-nav__link">
    get_var()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.hangup_call" class="md-nav__link">
    hangup_call()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.interaction_options" class="md-nav__link">
    interaction_options()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.is_group_member" class="md-nav__link">
    is_group_member()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.led_action" class="md-nav__link">
    led_action()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.led_info" class="md-nav__link">
    led_info()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.listen" class="md-nav__link">
    listen()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.log_message" class="md-nav__link">
    log_message()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.log_user_message" class="md-nav__link">
    log_user_message()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.make_target_uris" class="md-nav__link">
    make_target_uris()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.place_call" class="md-nav__link">
    place_call()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.play" class="md-nav__link">
    play()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.play_and_wait" class="md-nav__link">
    play_and_wait()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.play_unread_inbox_messages" class="md-nav__link">
    play_unread_inbox_messages()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.push_options" class="md-nav__link">
    push_options()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.rainbow" class="md-nav__link">
    rainbow()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.resolve_incident" class="md-nav__link">
    resolve_incident()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.rotate" class="md-nav__link">
    rotate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.say" class="md-nav__link">
    say()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.say_and_wait" class="md-nav__link">
    say_and_wait()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.set_channel" class="md-nav__link">
    set_channel()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.set_device_name" class="md-nav__link">
    set_device_name()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.set_timer" class="md-nav__link">
    set_timer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.set_user_profile" class="md-nav__link">
    set_user_profile()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.set_var" class="md-nav__link">
    set_var()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.start_interaction" class="md-nav__link">
    start_interaction()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.start_timer" class="md-nav__link">
    start_timer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.stop_timer" class="md-nav__link">
    stop_timer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.switch_all_led_off" class="md-nav__link">
    switch_all_led_off()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.switch_all_led_on" class="md-nav__link">
    switch_all_led_on()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.switch_led_on" class="md-nav__link">
    switch_led_on()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.targets_from_source_uri" class="md-nav__link">
    targets_from_source_uri()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.terminate" class="md-nav__link">
    terminate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.translate" class="md-nav__link">
    translate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.unset_var" class="md-nav__link">
    unset_var()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.vibrate" class="md-nav__link">
    vibrate()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.Server" class="md-nav__link">
    Server
  </a>
  
    <nav class="md-nav" aria-label="Server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Server.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.Workflow" class="md-nav__link">
    Workflow
  </a>
  
    <nav class="md-nav" aria-label="Workflow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_button" class="md-nav__link">
    on_button()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_call_connected" class="md-nav__link">
    on_call_connected()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_call_disconnected" class="md-nav__link">
    on_call_disconnected()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_call_failed" class="md-nav__link">
    on_call_failed()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_call_progressing" class="md-nav__link">
    on_call_progressing()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_call_received" class="md-nav__link">
    on_call_received()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_call_ringing" class="md-nav__link">
    on_call_ringing()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_call_start_request" class="md-nav__link">
    on_call_start_request()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_incident" class="md-nav__link">
    on_incident()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_interaction_lifecycle" class="md-nav__link">
    on_interaction_lifecycle()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_notification" class="md-nav__link">
    on_notification()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_play_inbox_message" class="md-nav__link">
    on_play_inbox_message()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_progress" class="md-nav__link">
    on_progress()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_prompt" class="md-nav__link">
    on_prompt()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_resume" class="md-nav__link">
    on_resume()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_sms" class="md-nav__link">
    on_sms()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_speech" class="md-nav__link">
    on_speech()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_start" class="md-nav__link">
    on_start()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_stop" class="md-nav__link">
    on_stop()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_timer" class="md-nav__link">
    on_timer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_timer_fired" class="md-nav__link">
    on_timer_fired()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.device_id" class="md-nav__link">
    device_id()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.device_name" class="md-nav__link">
    device_name()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.fetch_device" class="md-nav__link">
    fetch_device()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.group_id" class="md-nav__link">
    group_id()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.group_member" class="md-nav__link">
    group_member()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.group_name" class="md-nav__link">
    group_name()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.interaction_name" class="md-nav__link">
    interaction_name()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.is_interaction_uri" class="md-nav__link">
    is_interaction_uri()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.is_relay_uri" class="md-nav__link">
    is_relay_uri()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.parse_device_id" class="md-nav__link">
    parse_device_id()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.parse_device_name" class="md-nav__link">
    parse_device_name()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.parse_group_id" class="md-nav__link">
    parse_group_id()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.parse_group_name" class="md-nav__link">
    parse_group_name()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.parse_interaction" class="md-nav__link">
    parse_interaction()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.trigger_workflow" class="md-nav__link">
    trigger_workflow()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#relay.workflow" class="md-nav__link">
    workflow
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.Relay" class="md-nav__link">
    Relay
  </a>
  
    <nav class="md-nav" aria-label="Relay">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.alert" class="md-nav__link">
    alert()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.answer_call" class="md-nav__link">
    answer_call()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.breathe" class="md-nav__link">
    breathe()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.broadcast" class="md-nav__link">
    broadcast()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.cancel_alert" class="md-nav__link">
    cancel_alert()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.cancel_broadcast" class="md-nav__link">
    cancel_broadcast()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.clear_timer" class="md-nav__link">
    clear_timer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.create_incident" class="md-nav__link">
    create_incident()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.disable_location" class="md-nav__link">
    disable_location()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.enable_location" class="md-nav__link">
    enable_location()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.end_interaction" class="md-nav__link">
    end_interaction()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.flash" class="md-nav__link">
    flash()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.get_device_address" class="md-nav__link">
    get_device_address()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.get_device_battery" class="md-nav__link">
    get_device_battery()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.get_device_coordinates" class="md-nav__link">
    get_device_coordinates()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.get_device_id" class="md-nav__link">
    get_device_id()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.get_device_indoor_location" class="md-nav__link">
    get_device_indoor_location()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.get_device_latlong" class="md-nav__link">
    get_device_latlong()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.get_device_location" class="md-nav__link">
    get_device_location()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.get_device_location_enabled" class="md-nav__link">
    get_device_location_enabled()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.get_device_name" class="md-nav__link">
    get_device_name()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.get_device_type" class="md-nav__link">
    get_device_type()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.get_group_members" class="md-nav__link">
    get_group_members()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.get_number_var" class="md-nav__link">
    get_number_var()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.get_source_uri_from_trigger" class="md-nav__link">
    get_source_uri_from_trigger()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.get_unread_inbox_size" class="md-nav__link">
    get_unread_inbox_size()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.get_user_profile" class="md-nav__link">
    get_user_profile()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.get_var" class="md-nav__link">
    get_var()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.hangup_call" class="md-nav__link">
    hangup_call()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.interaction_options" class="md-nav__link">
    interaction_options()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.is_group_member" class="md-nav__link">
    is_group_member()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.led_action" class="md-nav__link">
    led_action()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.led_info" class="md-nav__link">
    led_info()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.listen" class="md-nav__link">
    listen()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.log_message" class="md-nav__link">
    log_message()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.log_user_message" class="md-nav__link">
    log_user_message()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.make_target_uris" class="md-nav__link">
    make_target_uris()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.place_call" class="md-nav__link">
    place_call()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.play" class="md-nav__link">
    play()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.play_and_wait" class="md-nav__link">
    play_and_wait()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.play_unread_inbox_messages" class="md-nav__link">
    play_unread_inbox_messages()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.push_options" class="md-nav__link">
    push_options()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.rainbow" class="md-nav__link">
    rainbow()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.resolve_incident" class="md-nav__link">
    resolve_incident()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.rotate" class="md-nav__link">
    rotate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.say" class="md-nav__link">
    say()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.say_and_wait" class="md-nav__link">
    say_and_wait()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.set_channel" class="md-nav__link">
    set_channel()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.set_device_name" class="md-nav__link">
    set_device_name()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.set_timer" class="md-nav__link">
    set_timer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.set_user_profile" class="md-nav__link">
    set_user_profile()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.set_var" class="md-nav__link">
    set_var()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.start_interaction" class="md-nav__link">
    start_interaction()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.start_timer" class="md-nav__link">
    start_timer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.stop_timer" class="md-nav__link">
    stop_timer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.switch_all_led_off" class="md-nav__link">
    switch_all_led_off()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.switch_all_led_on" class="md-nav__link">
    switch_all_led_on()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.switch_led_on" class="md-nav__link">
    switch_led_on()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.targets_from_source_uri" class="md-nav__link">
    targets_from_source_uri()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.terminate" class="md-nav__link">
    terminate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.translate" class="md-nav__link">
    translate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.unset_var" class="md-nav__link">
    unset_var()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Relay.vibrate" class="md-nav__link">
    vibrate()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.Server" class="md-nav__link">
    Server
  </a>
  
    <nav class="md-nav" aria-label="Server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Server.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.Workflow" class="md-nav__link">
    Workflow
  </a>
  
    <nav class="md-nav" aria-label="Workflow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_button" class="md-nav__link">
    on_button()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_call_connected" class="md-nav__link">
    on_call_connected()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_call_disconnected" class="md-nav__link">
    on_call_disconnected()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_call_failed" class="md-nav__link">
    on_call_failed()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_call_progressing" class="md-nav__link">
    on_call_progressing()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_call_received" class="md-nav__link">
    on_call_received()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_call_ringing" class="md-nav__link">
    on_call_ringing()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_call_start_request" class="md-nav__link">
    on_call_start_request()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_incident" class="md-nav__link">
    on_incident()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_interaction_lifecycle" class="md-nav__link">
    on_interaction_lifecycle()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_notification" class="md-nav__link">
    on_notification()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_play_inbox_message" class="md-nav__link">
    on_play_inbox_message()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_progress" class="md-nav__link">
    on_progress()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_prompt" class="md-nav__link">
    on_prompt()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_resume" class="md-nav__link">
    on_resume()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_sms" class="md-nav__link">
    on_sms()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_speech" class="md-nav__link">
    on_speech()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_start" class="md-nav__link">
    on_start()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_stop" class="md-nav__link">
    on_stop()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_timer" class="md-nav__link">
    on_timer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relay.workflow.Workflow.on_timer_fired" class="md-nav__link">
    on_timer_fired()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.device_id" class="md-nav__link">
    device_id()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.device_name" class="md-nav__link">
    device_name()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.fetch_device" class="md-nav__link">
    fetch_device()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.group_id" class="md-nav__link">
    group_id()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.group_member" class="md-nav__link">
    group_member()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.group_name" class="md-nav__link">
    group_name()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.interaction_name" class="md-nav__link">
    interaction_name()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.is_interaction_uri" class="md-nav__link">
    is_interaction_uri()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.is_relay_uri" class="md-nav__link">
    is_relay_uri()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.parse_device_id" class="md-nav__link">
    parse_device_id()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.parse_device_name" class="md-nav__link">
    parse_device_name()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.parse_group_id" class="md-nav__link">
    parse_group_id()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.parse_group_name" class="md-nav__link">
    parse_group_name()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.parse_interaction" class="md-nav__link">
    parse_interaction()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relay.workflow.trigger_workflow" class="md-nav__link">
    trigger_workflow()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="build-workflows-for-your-relays">Build workflows for your Relays</h1>


<div class="doc doc-object doc-module">



<a id="relay.workflow"></a>
  <div class="doc doc-contents first">
  
      <p>A module for implementing Relay workflows in Python. This is the SDK that
provides a way for your enterprise to extend your I/T tools to your active
workers via Relay devices. There are APIs for text-to-speech (say),
speech-to-text (listen), LED control, vibration control, location
information, NFC tag taps, etc. See <a href="https://developer.relaypro.com">https://developer.relaypro.com</a></p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h2 id="relay.workflow.Relay" class="doc doc-heading">
          <code>Relay</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Includes the main functionalities that are used within workflows,
such as functions for communicating with the device, sending out
notifications to groups, handling workflow events, and performing physical actions
on the device such as manipulating LEDs and creating vibrations.</p>

            <details class="quote">
              <summary>Source code in <code>relay/workflow.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span>
<span class="normal">2074</span>
<span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span>
<span class="normal">2082</span>
<span class="normal">2083</span>
<span class="normal">2084</span>
<span class="normal">2085</span>
<span class="normal">2086</span>
<span class="normal">2087</span>
<span class="normal">2088</span>
<span class="normal">2089</span>
<span class="normal">2090</span>
<span class="normal">2091</span>
<span class="normal">2092</span>
<span class="normal">2093</span>
<span class="normal">2094</span>
<span class="normal">2095</span>
<span class="normal">2096</span>
<span class="normal">2097</span>
<span class="normal">2098</span>
<span class="normal">2099</span>
<span class="normal">2100</span>
<span class="normal">2101</span>
<span class="normal">2102</span>
<span class="normal">2103</span>
<span class="normal">2104</span>
<span class="normal">2105</span>
<span class="normal">2106</span>
<span class="normal">2107</span>
<span class="normal">2108</span>
<span class="normal">2109</span>
<span class="normal">2110</span>
<span class="normal">2111</span>
<span class="normal">2112</span>
<span class="normal">2113</span>
<span class="normal">2114</span>
<span class="normal">2115</span>
<span class="normal">2116</span>
<span class="normal">2117</span>
<span class="normal">2118</span>
<span class="normal">2119</span>
<span class="normal">2120</span>
<span class="normal">2121</span>
<span class="normal">2122</span>
<span class="normal">2123</span>
<span class="normal">2124</span>
<span class="normal">2125</span>
<span class="normal">2126</span>
<span class="normal">2127</span>
<span class="normal">2128</span>
<span class="normal">2129</span>
<span class="normal">2130</span>
<span class="normal">2131</span>
<span class="normal">2132</span>
<span class="normal">2133</span>
<span class="normal">2134</span>
<span class="normal">2135</span>
<span class="normal">2136</span>
<span class="normal">2137</span>
<span class="normal">2138</span>
<span class="normal">2139</span>
<span class="normal">2140</span>
<span class="normal">2141</span>
<span class="normal">2142</span>
<span class="normal">2143</span>
<span class="normal">2144</span>
<span class="normal">2145</span>
<span class="normal">2146</span>
<span class="normal">2147</span>
<span class="normal">2148</span>
<span class="normal">2149</span>
<span class="normal">2150</span>
<span class="normal">2151</span>
<span class="normal">2152</span>
<span class="normal">2153</span>
<span class="normal">2154</span>
<span class="normal">2155</span>
<span class="normal">2156</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Relay</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Includes the main functionalities that are used within workflows,</span>
<span class="sd">    such as functions for communicating with the device, sending out</span>
<span class="sd">    notifications to groups, handling workflow events, and performing physical actions</span>
<span class="sd">    on the device such as manipulating LEDs and creating vibrations.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">workflow</span><span class="p">:</span> <span class="n">Workflow</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes workflow fields.</span>

<span class="sd">        Args:</span>
<span class="sd">            workflow (Workflow): your workflow.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">workflow</span> <span class="o">=</span> <span class="n">workflow</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">websocket</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id_futures</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># {_id: future}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">event_futures</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_get_cid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># correlation id</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">workflow</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">websocket</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>

    <span class="k">def</span> <span class="nf">_from_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">websocket_message</span><span class="p">):</span>
        <span class="n">dict_message</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">websocket_message</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clean_int_arrays</span><span class="p">(</span><span class="n">dict_message</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_clean_int_arrays</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dict_message</span><span class="p">):</span>
        <span class="c1"># work around the JSON formatting issue in iBot</span>
        <span class="c1"># that gives us an array of ints instead of a string:</span>
        <span class="c1"># will be fixed in iBot 3.10 via PE-17571</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dict_message</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dict_message</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dict_message</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
                    <span class="n">dict_message</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clean_int_arrays</span><span class="p">(</span><span class="n">dict_message</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dict_message</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">all_int</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">dict_message</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                    <span class="n">all_int</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="n">all_int</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dict_message</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">dict_message</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dict_message</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dict_message</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_validate_trigger</span><span class="p">(</span><span class="n">trigger</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">trigger</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">WorkflowException</span><span class="p">(</span><span class="s1">&#39;trigger parameter is not a dictionary&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;args&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">trigger</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">WorkflowException</span><span class="p">(</span><span class="s1">&#39;trigger parameter is not a trigger dictionary&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;source_uri&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">trigger</span><span class="p">[</span><span class="s1">&#39;args&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">WorkflowException</span><span class="p">(</span><span class="s1">&#39;there is no source_uri definition in the trigger&#39;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">make_target_uris</span><span class="p">(</span><span class="n">trigger</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a target URN after receiving a workflow trigger.</span>

<span class="sd">        Args:</span>
<span class="sd">            trigger (dict): workflow trigger.</span>

<span class="sd">        Raises:</span>
<span class="sd">            WorkflowException: thrown if the trigger param is not a dictionary.</span>
<span class="sd">            WorkflowException: thrown if the trigger param is not a trigger dictionary.</span>
<span class="sd">            WorkflowException: thrown if there is no source_uri definition in the trigger.</span>

<span class="sd">        Returns:</span>
<span class="sd">            a target object created from the trigger.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Relay</span><span class="o">.</span><span class="n">_validate_trigger</span><span class="p">(</span><span class="n">trigger</span><span class="p">)</span>
        <span class="n">target</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;uris&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">trigger</span><span class="p">[</span><span class="s1">&#39;args&#39;</span><span class="p">][</span><span class="s1">&#39;source_uri&#39;</span><span class="p">]]</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">target</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_source_uri_from_trigger</span><span class="p">(</span><span class="n">trigger</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the source URN from a workflow trigger</span>

<span class="sd">        Args:</span>
<span class="sd">            trigger (dict): workflow trigger.</span>

<span class="sd">        Raises:</span>
<span class="sd">            WorkflowException: thrown if the trigger param is not a dictionary.</span>
<span class="sd">            WorkflowException: thrown if the trigger param is not a trigger dictionary.</span>
<span class="sd">            WorkflowException: thrown if there is no source_uri definition in the trigger.</span>

<span class="sd">        Returns:</span>
<span class="sd">            the source URN as a string from the trigger.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Relay</span><span class="o">.</span><span class="n">_validate_trigger</span><span class="p">(</span><span class="n">trigger</span><span class="p">)</span>
        <span class="n">source_uri</span> <span class="o">=</span> <span class="n">trigger</span><span class="p">[</span><span class="s1">&#39;args&#39;</span><span class="p">][</span><span class="s1">&#39;source_uri&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">source_uri</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">targets_from_source_uri</span><span class="p">(</span><span class="n">source_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a target object from a source URN.</span>
<span class="sd">        Enables the device to perform the desired action after the function</span>
<span class="sd">        has been called.  Used interanlly by interaction functions such as</span>
<span class="sd">        say(), listen(), vibration(), etc.</span>

<span class="sd">        Args:</span>
<span class="sd">            source_uri (str): source uri that will be used to create a target.</span>

<span class="sd">        Returns:</span>
<span class="sd">            the target that was created from a source URN.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">targets</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;uris&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">source_uri</span><span class="p">]</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">targets</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">websocket</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">websocket</span> <span class="o">=</span> <span class="n">websocket</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">CustomAdapter</span><span class="p">(</span><span class="n">logger</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;cid&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cid</span><span class="p">()})</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;workflow instance started for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">websocket</span><span class="o">.</span><span class="n">path</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">async</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">websocket</span><span class="p">:</span>
                <span class="c1"># TODO: restore after PE-17571</span>
                <span class="c1"># self.logger.debug(f&#39;recv raw: {m}&#39;)</span>
                <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_from_json</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;recv: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="n">_id</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;_id&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="n">_type</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;_type&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

                <span class="n">fut</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">id_futures</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">_id</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">fut</span><span class="p">:</span>
                    <span class="n">fut</span><span class="o">.</span><span class="n">set_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">handled</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="n">future</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pop_event_match</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">future</span><span class="p">:</span>
                        <span class="n">future</span><span class="o">.</span><span class="n">set_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                        <span class="n">handled</span> <span class="o">=</span> <span class="kc">True</span>

                    <span class="c1"># events that don&#39;t have an _id field (some events do have an _id field for async response data)</span>
                    <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workflow</span><span class="o">.</span><span class="n">get_handler</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">h</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">_type</span> <span class="o">==</span> <span class="s1">&#39;wf_api_start_event&#39;</span><span class="p">:</span>
                            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_wrapper</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;trigger&#39;</span><span class="p">]))</span>

                        <span class="k">elif</span> <span class="n">_type</span> <span class="o">==</span> <span class="s1">&#39;wf_api_stop_event&#39;</span><span class="p">:</span>
                            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_wrapper</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;reason&#39;</span><span class="p">]))</span>

                        <span class="k">elif</span> <span class="n">_type</span> <span class="o">==</span> <span class="s1">&#39;wf_api_prompt_event&#39;</span><span class="p">:</span>
                            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_wrapper</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;source_uri&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]))</span>

                        <span class="k">elif</span> <span class="n">_type</span> <span class="o">==</span> <span class="s1">&#39;wf_api_button_event&#39;</span><span class="p">:</span>
                            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_wrapper</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;button&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;taps&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;source_uri&#39;</span><span class="p">]))</span>

                        <span class="k">elif</span> <span class="n">_type</span> <span class="o">==</span> <span class="s1">&#39;wf_api_notification_event&#39;</span><span class="p">:</span>
                            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">_wrapper</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;event&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;notification_state&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;source_uri&#39;</span><span class="p">]))</span>

                        <span class="k">elif</span> <span class="n">_type</span> <span class="o">==</span> <span class="s1">&#39;wf_api_timer_event&#39;</span><span class="p">:</span>
                            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_wrapper</span><span class="p">(</span><span class="n">h</span><span class="p">))</span>

                        <span class="k">elif</span> <span class="n">_type</span> <span class="o">==</span> <span class="s1">&#39;wf_api_timer_fired_event&#39;</span><span class="p">:</span>
                            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_wrapper</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]))</span>

                        <span class="k">elif</span> <span class="n">_type</span> <span class="o">==</span> <span class="s1">&#39;wf_api_speech_event&#39;</span><span class="p">:</span>
                            <span class="n">text</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;text&#39;</span> <span class="ow">in</span> <span class="n">e</span> <span class="k">else</span> <span class="kc">None</span>
                            <span class="n">audio</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;audio&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;audio&#39;</span> <span class="ow">in</span> <span class="n">e</span> <span class="k">else</span> <span class="kc">None</span>
                            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">_wrapper</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">audio</span><span class="p">,</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;lang&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;request_id&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;source_uri&#39;</span><span class="p">]))</span>

                        <span class="k">elif</span> <span class="n">_type</span> <span class="o">==</span> <span class="s1">&#39;wf_api_progress_event&#39;</span><span class="p">:</span>
                            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_wrapper</span><span class="p">(</span><span class="n">h</span><span class="p">))</span>

                        <span class="k">elif</span> <span class="n">_type</span> <span class="o">==</span> <span class="s1">&#39;wf_api_play_inbox_message_event&#39;</span><span class="p">:</span>
                            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_wrapper</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]))</span>

                        <span class="k">elif</span> <span class="n">_type</span> <span class="o">==</span> <span class="s1">&#39;wf_api_call_connected_event&#39;</span><span class="p">:</span>
                            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">_wrapper</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;call_id&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;device_id&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;device_name&#39;</span><span class="p">],</span>
                                              <span class="n">e</span><span class="p">[</span><span class="s1">&#39;uri&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;onnet&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;start_time_epoch&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;connect_time_epoch&#39;</span><span class="p">]))</span>

                        <span class="k">elif</span> <span class="n">_type</span> <span class="o">==</span> <span class="s1">&#39;wf_api_call_disconnected_event&#39;</span><span class="p">:</span>
                            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">_wrapper</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;call_id&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;device_id&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;device_name&#39;</span><span class="p">],</span>
                                              <span class="n">e</span><span class="p">[</span><span class="s1">&#39;uri&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;onnet&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;reason&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;start_time_epoch&#39;</span><span class="p">],</span>
                                              <span class="n">e</span><span class="p">[</span><span class="s1">&#39;connect_time_epoch&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;end_time_epoch&#39;</span><span class="p">]))</span>

                        <span class="k">elif</span> <span class="n">_type</span> <span class="o">==</span> <span class="s1">&#39;wf_api_call_failed_event&#39;</span><span class="p">:</span>
                            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">_wrapper</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;call_id&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;device_id&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;device_name&#39;</span><span class="p">],</span>
                                              <span class="n">e</span><span class="p">[</span><span class="s1">&#39;uri&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;onnet&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;reason&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;start_time_epoch&#39;</span><span class="p">],</span>
                                              <span class="n">e</span><span class="p">[</span><span class="s1">&#39;connect_time_epoch&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;end_time_epoch&#39;</span><span class="p">]))</span>

                        <span class="k">elif</span> <span class="n">_type</span> <span class="o">==</span> <span class="s1">&#39;wf_api_call_received_event&#39;</span><span class="p">:</span>
                            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">_wrapper</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;call_id&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;device_id&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;device_name&#39;</span><span class="p">],</span>
                                              <span class="n">e</span><span class="p">[</span><span class="s1">&#39;uri&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;onnet&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;start_time_epoch&#39;</span><span class="p">]))</span>

                        <span class="k">elif</span> <span class="n">_type</span> <span class="o">==</span> <span class="s1">&#39;wf_api_call_ringing_event&#39;</span><span class="p">:</span>
                            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">_wrapper</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;call_id&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;device_id&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;device_name&#39;</span><span class="p">],</span>
                                              <span class="n">e</span><span class="p">[</span><span class="s1">&#39;uri&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;onnet&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;start_time_epoch&#39;</span><span class="p">]))</span>

                        <span class="k">elif</span> <span class="n">_type</span> <span class="o">==</span> <span class="s1">&#39;wf_api_call_progressing_event&#39;</span><span class="p">:</span>
                            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">_wrapper</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;call_id&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;device_id&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;device_name&#39;</span><span class="p">],</span>
                                              <span class="n">e</span><span class="p">[</span><span class="s1">&#39;uri&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;onnet&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;start_time_epoch&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;connect_time_epoch&#39;</span><span class="p">]))</span>

                        <span class="k">elif</span> <span class="n">_type</span> <span class="o">==</span> <span class="s1">&#39;wf_api_call_start_request_event&#39;</span><span class="p">:</span>
                            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_wrapper</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;uri&#39;</span><span class="p">]))</span>

                        <span class="k">elif</span> <span class="n">_type</span> <span class="o">==</span> <span class="s1">&#39;wf_api_sms_event&#39;</span><span class="p">:</span>
                            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_wrapper</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;event&#39;</span><span class="p">]))</span>

                        <span class="k">elif</span> <span class="n">_type</span> <span class="o">==</span> <span class="s1">&#39;wf_api_incident_event&#39;</span><span class="p">:</span>
                            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_wrapper</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;incident_id&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;reason&#39;</span><span class="p">]))</span>

                        <span class="k">elif</span> <span class="n">_type</span> <span class="o">==</span> <span class="s1">&#39;wf_api_interaction_lifecycle_event&#39;</span><span class="p">:</span>
                            <span class="n">reason</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;reason&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;reason&#39;</span> <span class="ow">in</span> <span class="n">e</span> <span class="k">else</span> <span class="kc">None</span>
                            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_wrapper</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;source_uri&#39;</span><span class="p">],</span> <span class="n">reason</span><span class="p">))</span>

                        <span class="k">elif</span> <span class="n">_type</span> <span class="o">==</span> <span class="s1">&#39;wf_api_resume_event&#39;</span><span class="p">:</span>
                            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_wrapper</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;trigger&#39;</span><span class="p">]))</span>

                    <span class="k">elif</span> <span class="ow">not</span> <span class="n">handled</span><span class="p">:</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">_type</span> <span class="o">==</span> <span class="s1">&#39;wf_api_prompt_event&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">_type</span> <span class="o">==</span> <span class="s1">&#39;wf_api_speech_event&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
                                <span class="n">_type</span> <span class="o">==</span> <span class="s1">&#39;wf_api_stop_event&#39;</span><span class="p">):</span>
                            <span class="n">level</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">level</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;no handler found for _type </span><span class="si">{</span><span class="n">e</span><span class="p">[</span><span class="s2">&quot;_type&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># the &quot;exceptions&quot; module is really what we receive</span>
        <span class="k">except</span> <span class="n">websockets</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ConnectionClosedError</span><span class="p">:</span>
            <span class="c1"># ibot closes the connection on terminate(); this is expected</span>
            <span class="k">pass</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">x</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;workflow instance terminated&#39;</span><span class="p">)</span>

    <span class="c1"># run handlers with exception logging; needed since we cannot await handlers</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">_wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">h</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">x</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="n">_id</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span>
        <span class="n">obj</span><span class="p">[</span><span class="s1">&#39;_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_id</span>

        <span class="c1"># TODO: ibot add responses to all _request events? if so, await them here ... and check for error responses</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_str</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_send_receive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">uid</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">_id</span> <span class="o">=</span> <span class="n">uid</span> <span class="k">if</span> <span class="n">uid</span> <span class="k">else</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span>
        <span class="n">obj</span><span class="p">[</span><span class="s1">&#39;_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_id</span>
        <span class="n">fut</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_future</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id_futures</span><span class="p">[</span><span class="n">_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">fut</span>

        <span class="c1"># TODO: ibot currently loads null as the string &#39;null&#39;</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_str</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">remove_null</span><span class="p">(</span><span class="n">obj</span><span class="p">)))</span>
        <span class="c1"># wait on the response</span>
        <span class="k">await</span> <span class="n">fut</span>
        <span class="n">rsp</span> <span class="o">=</span> <span class="n">fut</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">rsp</span><span class="p">[</span><span class="s1">&#39;_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;wf_api_error_response&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">WorkflowException</span><span class="p">(</span><span class="n">rsp</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">fut</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_send_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;send: </span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">websocket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieves a variable that was set either during workflow registration</span>
<span class="sd">        or through the set_var() function.  The variable can be retrieved anywhere</span>
<span class="sd">        within the workflow, but is erased after the workflow terminates.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): name of the variable to be retrieved.</span>
<span class="sd">            default (optional): default value of the variable if it does not exist. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            the variable requested.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO: look in self.workflow.state to see all of what is available</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_get_var_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span>
        <span class="p">}</span>
        <span class="n">v</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_number_var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieves a variable that was set either during workflow registration</span>
<span class="sd">        or through the set_var() function of type integer.  The variable can be retrieved anywhere</span>
<span class="sd">        within the workflow, but is erased after the workflow terminates.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): name of the variable to be retrieved.</span>
<span class="sd">            default (optional): default value of the variable if it does not exist. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            the variable requested.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_var</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">))</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">set_var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets a variable with the corresponding name and value. Scope of</span>
<span class="sd">        the variable is from start to end of a workflow.  Note that you </span>
<span class="sd">        can only set values of type string.</span>
<span class="sd">        Args:</span>
<span class="sd">            name (str): name of the variable to be created.</span>
<span class="sd">            value (str): value that the variable will hold.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_set_var_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
            <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">value</span>
        <span class="p">}</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">unset_var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Unsets the value of a variable.  </span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): the name of the variable whose value you would like to unset.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_unset_var_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span>
        <span class="p">}</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">interaction_options</span><span class="p">(</span><span class="n">color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;0000ff&quot;</span><span class="p">,</span> <span class="n">input_types</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">home_channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;suspend&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Options for when an interaction is started via a workflow.</span>

<span class="sd">        Args:</span>
<span class="sd">            color (str, optional): desired color of LEDs when an interaction is started. Defaults to &quot;0000ff&quot;.</span>
<span class="sd">            input_types (list, optional): input types you would like for the interaction. Defaults to an empty list.</span>
<span class="sd">            home_channel (str, optional): home channel for the device during the interaction. Defaults to &quot;suspend&quot;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            the options specified.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">input_types</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">input_types</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">,</span>
            <span class="s1">&#39;input_types&#39;</span><span class="p">:</span> <span class="n">input_types</span><span class="p">,</span>
            <span class="s1">&#39;home_channel&#39;</span><span class="p">:</span> <span class="n">home_channel</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">options</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">start_interaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Starts an interaction with the user.  Triggers an INTERACTION_STARTED event</span>
<span class="sd">        and allows the user to interact with the device via functions that require an </span>
<span class="sd">        interaction URN.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (target): the device that you would like to start an interaction with.</span>
<span class="sd">            name (str): a name for your interaction.</span>
<span class="sd">            options (optional): can be color, home channel, or input types. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_start_interaction_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="n">target</span><span class="p">,</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
            <span class="s1">&#39;options&#39;</span><span class="p">:</span> <span class="n">options</span>
        <span class="p">}</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">end_interaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Ends an interaction with the user.  Triggers an INTERACTION_ENDED event to signify</span>
<span class="sd">        that the user is done interacting with the device.</span>

<span class="sd">        Args:</span>
<span class="sd">            target(str): the interaction that you would like to end.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_end_interaction_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_event_match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">criteria</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">criteria</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">WorkflowException</span><span class="p">(</span><span class="s2">&quot;criteria is not a dict&quot;</span><span class="p">)</span>
        <span class="n">match_data</span> <span class="o">=</span> <span class="n">criteria</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">uid</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span>
        <span class="n">future</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_future</span><span class="p">()</span>
        <span class="n">match_data</span><span class="p">[</span><span class="s1">&#39;_timestamp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">match_data</span><span class="p">[</span><span class="s1">&#39;_future&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">future</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">event_futures</span><span class="p">[</span><span class="n">uid</span><span class="p">]</span> <span class="o">=</span> <span class="n">match_data</span>
        <span class="k">return</span> <span class="n">future</span>

    <span class="nd">@staticmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">_wait_for_event_match</span><span class="p">(</span><span class="n">future</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span><span class="n">future</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span>
        <span class="n">event</span> <span class="o">=</span> <span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">event</span><span class="p">[</span><span class="s1">&#39;_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;wf_api_error_response&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">WorkflowException</span><span class="p">(</span><span class="n">event</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">event</span>

    <span class="k">def</span> <span class="nf">_pop_event_match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="c1"># check if event matches anything we are waiting for</span>
        <span class="n">now</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">uid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">event_futures</span><span class="p">:</span>
            <span class="c1"># purge old items (30 minutes)</span>
            <span class="n">age</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">event_futures</span><span class="p">[</span><span class="n">uid</span><span class="p">][</span><span class="s1">&#39;_timestamp&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">age</span> <span class="o">&gt;</span> <span class="mi">1800</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">event_futures</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">uid</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="n">matches</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">event_futures</span><span class="p">[</span><span class="n">uid</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;_timestamp&#39;</span> <span class="ow">or</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;_future&#39;</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="c1"># if event doesn&#39;t have criteria item, then fail</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">event</span><span class="p">:</span>
                    <span class="n">matches</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">break</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">event_futures</span><span class="p">[</span><span class="n">uid</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">!=</span> <span class="n">event</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
                    <span class="n">matches</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="n">matches</span><span class="p">:</span>
                <span class="n">future</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">event_futures</span><span class="p">[</span><span class="n">uid</span><span class="p">][</span><span class="s1">&#39;_future&#39;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">event_futures</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">uid</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">future</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">listen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">phrases</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transcribe</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">alt_lang</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">60</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Listens for the user to speak into the device.  Utilizes speech to text functionality to interact</span>
<span class="sd">        with the user.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the interaction URN.</span>
<span class="sd">            phrases (string[], optional): optional phrases that you would like to limit the user&#39;s response to.</span>
<span class="sd">             Defaults to None.</span>
<span class="sd">            transcribe (bool, optional): whether you would like to transcribe the user&#39;s reponse. Defaults to True.</span>
<span class="sd">            timeout (int, optional): timeout for how long the device will wait for user&#39;s response. Defaults to 60.</span>
<span class="sd">            alt_lang (str, optional): if you would like the device to listen for a response in a specific language.</span>
<span class="sd">             Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            text representation of what the user had spoken into the device.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">phrases</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">phrases</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">phrases</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">phrases</span> <span class="o">=</span> <span class="p">[</span><span class="n">phrases</span><span class="p">]</span>

        <span class="n">_id</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_listen_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
            <span class="s1">&#39;phrases&#39;</span><span class="p">:</span> <span class="n">phrases</span><span class="p">,</span>
            <span class="s1">&#39;transcribe&#39;</span><span class="p">:</span> <span class="n">transcribe</span><span class="p">,</span>
            <span class="s1">&#39;timeout&#39;</span><span class="p">:</span> <span class="n">timeout</span><span class="p">,</span>
            <span class="s1">&#39;alt_lang&#39;</span><span class="p">:</span> <span class="n">alt_lang</span>
        <span class="p">}</span>

        <span class="n">criteria</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_speech_event&#39;</span><span class="p">,</span>
            <span class="s1">&#39;request_id&#39;</span><span class="p">:</span> <span class="n">_id</span>
        <span class="p">}</span>
        <span class="c1"># need to add this before _send_receive to avoid race condition</span>
        <span class="n">event_future</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_event_match</span><span class="p">(</span><span class="n">criteria</span><span class="p">)</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">_id</span><span class="p">)</span>
        <span class="n">speech_event</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_event_match</span><span class="p">(</span><span class="n">event_future</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">transcribe</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">speech_event</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">speech_event</span><span class="p">[</span><span class="s1">&#39;audio&#39;</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">play</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plays a custom audio file that was uploaded by the user.</span>

<span class="sd">        Args:</span>
<span class="sd">            target(str): the interaction URN.</span>
<span class="sd">            filename (str): the name of the audio file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            the response id after the audio file has been played on the device.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_play_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
            <span class="s1">&#39;filename&#39;</span><span class="p">:</span> <span class="n">filename</span>
        <span class="p">}</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">play_and_wait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plays a custom audio file that was uploaded by the user.</span>
<span class="sd">        Waits until the audio file has finished playing before continuing through</span>
<span class="sd">        the workflow.</span>

<span class="sd">        Args:</span>
<span class="sd">            target(str): the interaction URN.</span>
<span class="sd">            filename (str): the name of the audio file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            the response id after the audio file has been played on the device.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_id</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_play_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
            <span class="s1">&#39;filename&#39;</span><span class="p">:</span> <span class="n">filename</span>
        <span class="p">}</span>

        <span class="n">criteria</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_prompt_event&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;stopped&#39;</span><span class="p">,</span>
            <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">_id</span>
        <span class="p">}</span>

        <span class="n">event_future</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_event_match</span><span class="p">(</span><span class="n">criteria</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">_id</span><span class="p">)</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_event_match</span><span class="p">(</span><span class="n">event_future</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">say</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">lang</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;en-US&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Utilizes text to speech capabilities to make the device &#39;speak&#39; to the user.</span>

<span class="sd">        Args:</span>
<span class="sd">            target(str): the interaction URN.</span>
<span class="sd">            text (str): what you would like the device to say.</span>
<span class="sd">            lang (str, optional): the language of the text that is being spoken. Defaults to &#39;en-US&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            the response ID after the device speaks to the user.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_say_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
            <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="n">text</span><span class="p">,</span>
            <span class="s1">&#39;lang&#39;</span><span class="p">:</span> <span class="n">lang</span>
        <span class="p">}</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">say_and_wait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">lang</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;en-US&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Utilizes text to speech capabilities to make the device &#39;speak&#39; to the user.</span>
<span class="sd">        Waits until the text is fully played out on the device before continuing.</span>

<span class="sd">        Args:</span>
<span class="sd">            target(str): the interaction URN.</span>
<span class="sd">            text (str): what you would like the device to say.</span>
<span class="sd">            lang (str, optional): the language of the text that is being spoken. Defaults to &#39;en-US&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            the response ID after the device speaks to the user.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_id</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_say_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
            <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="n">text</span><span class="p">,</span>
            <span class="s1">&#39;lang&#39;</span><span class="p">:</span> <span class="n">lang</span>
        <span class="p">}</span>

        <span class="n">criteria</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_prompt_event&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;stopped&#39;</span><span class="p">,</span>
            <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">_id</span><span class="p">}</span>

        <span class="n">event_future</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_event_match</span><span class="p">(</span><span class="n">criteria</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">_id</span><span class="p">)</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_event_match</span><span class="p">(</span><span class="n">event_future</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;wait complete for </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">push_options</span><span class="p">(</span><span class="n">priority</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">body</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">sound</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Push options for a virtual device after receiving a notification on the Relay App.</span>

<span class="sd">        Args:</span>
<span class="sd">            priority (str, optional): priority of the notification. Can be &#39;normal&#39;, &#39;high&#39;, or &#39;critical&#39;.</span>
<span class="sd">             Defaults to &#39;normal&#39;.</span>
<span class="sd">            title (str, optional): title of the notification. Defaults to None.</span>
<span class="sd">            body (str, optional): body of the notification. Defaults to None.</span>
<span class="sd">            sound (str, optional): sound to be played when notification appears on app. Can be &#39;default&#39;, or &#39;sos&#39;.</span>
<span class="sd">              Defaults to &#39;default&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            the options for priority and sound as specified.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;priority&#39;</span><span class="p">:</span> <span class="n">priority</span><span class="p">,</span>
            <span class="s1">&#39;sound&#39;</span><span class="p">:</span> <span class="n">sound</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">title</span>
        <span class="k">if</span> <span class="n">body</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">body</span>
        <span class="k">return</span> <span class="n">options</span>

    <span class="c1"># target properties: uri: array of string ids</span>

    <span class="c1"># repeating tone plus tts until button press</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">alert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">originator</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">push_opts</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sends out an alert to the specified group of devices and the Relay Dash.</span>

<span class="sd">        Args:</span>
<span class="sd">            target(str): the group URN that you would like to send an alert to.</span>
<span class="sd">            originator (str): the URN of the device that triggered the alert.</span>
<span class="sd">            name (str): a name for your alert.</span>
<span class="sd">            text (str): the text that you would like to be spoken to the group as your alert.</span>
<span class="sd">            push_opts (dict, optional): push options for if the alert is sent to the Relay app on a virtual device.</span>
<span class="sd">             Defaults to an empty value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">push_opts</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">push_opts</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_notification</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">originator</span><span class="p">,</span> <span class="s1">&#39;alert&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">push_opts</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">cancel_alert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Cancels an alert that was sent to a group of devices.  Particularly useful if you would like to cancel</span>
<span class="sd">         the alert on all devices after one device has acknowledged the alert.</span>

<span class="sd">        Args:</span>
<span class="sd">            target(str): the device URN that has acknowledged the alert.</span>
<span class="sd">            name (str): the name of the alert.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_notification</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;cancel&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">broadcast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">originator</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">push_opts</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sends out a broadcast message to a group of devices.  The message is played out on</span>
<span class="sd">        all devices, as well as sent to the Relay Dash.</span>

<span class="sd">        Args:</span>
<span class="sd">            target(str): the group URN that you would like to broadcast your message to.</span>
<span class="sd">            originator (str): the device URN that triggered the broadcast.</span>
<span class="sd">            name (str): a name for your broadcast.</span>
<span class="sd">            text (str): the text that you would like to be broadcasted to your group.</span>
<span class="sd">            push_opts (dict, optional): push options for if the broadcast is sent to the Relay app on a virtual</span>
<span class="sd">             device. Defaults to an empty value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">push_opts</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">push_opts</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_notification</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">originator</span><span class="p">,</span> <span class="s1">&#39;broadcast&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">push_opts</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">cancel_broadcast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Cancels the broadcast that was sent to a group of devices.</span>

<span class="sd">        Args:</span>
<span class="sd">            target(str): the device URN that is cancelling the broadcast.</span>
<span class="sd">            name (str): the name of the broadcast that you would like to cancel.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_notification</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;cancel&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_send_notification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">originator</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">ntype</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                                 <span class="n">text</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">push_opts</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Used for sending a notification on the server.  Private method that is</span>
<span class="sd">        used by alert() and broadcast().</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the group URN that you are sending a notification to.</span>
<span class="sd">            originator (str): the device that triggered the notification.</span>
<span class="sd">            ntype (str): the type of notification, either &#39;alert&#39; or &#39;broadcast&#39;.</span>
<span class="sd">            name (str): a name for your notification.</span>
<span class="sd">            text (str): the text of your notification.</span>
<span class="sd">            push_opts (dict, optional): allows you to customize the push notification sent to a virtual device.</span>
<span class="sd">             Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_notification_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
            <span class="s1">&#39;originator&#39;</span><span class="p">:</span> <span class="n">originator</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">ntype</span><span class="p">,</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
            <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="n">text</span><span class="p">,</span>
            <span class="s1">&#39;target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
            <span class="s1">&#39;push_opts&#39;</span><span class="p">:</span> <span class="n">push_opts</span>
        <span class="p">}</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">set_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">channel_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">suppress_tts</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                          <span class="n">disable_home_channel</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets the channel that a device is on.  This can be used to change the channel of a device during a workflow,</span>
<span class="sd">        where the channel will also be updated on the Relay Dash.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the device or interaction URN.</span>
<span class="sd">            channel_name (str): the name of the channel you would like to set your device to.</span>
<span class="sd">            suppress_tts (bool, optional): whether you would like to surpress text to speech. Defaults to False.</span>
<span class="sd">            disable_home_channel (bool, optional): whether you would like to disable the home channel.</span>
<span class="sd">             Defaults to False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_set_channel_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
            <span class="s1">&#39;channel_name&#39;</span><span class="p">:</span> <span class="n">channel_name</span><span class="p">,</span>
            <span class="s1">&#39;suppress_tts&#39;</span><span class="p">:</span> <span class="n">suppress_tts</span><span class="p">,</span>
            <span class="s1">&#39;disable_home_channel&#39;</span><span class="p">:</span> <span class="n">disable_home_channel</span>
        <span class="p">}</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_device_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the name of a targeted device.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the device or interaction URN.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: the name of the device.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">v</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_device_info</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_device_address</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">refresh</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the address of a targeted device.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the device or interaction URN.</span>
<span class="sd">            refresh (bool, optional): whether you would like to refresh before retrieving the address.</span>
<span class="sd">             Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: the address of the device.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_device_location</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">refresh</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_device_location</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">refresh</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the location of a targeted device.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the device or interaction URN.</span>
<span class="sd">            refresh (bool, optional): whether you would like to refresh before retrieving the location.</span>
<span class="sd">             Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: the location of the device.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">v</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_device_info</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;address&#39;</span><span class="p">,</span> <span class="n">refresh</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;address&#39;</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_device_latlong</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">refresh</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the latitude and longitude coordinates of a targeted device.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the device or interaction URN.</span>
<span class="sd">            refresh (bool, optional): whether you would like to refresh before retrieving the coordinates.</span>
<span class="sd">             Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float[]: an array containing the latitude and longitude of the device.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_device_coordinates</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">refresh</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_device_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">refresh</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieves the coordinates of the device&#39;s location.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the device or interaction URN.</span>
<span class="sd">            refresh (bool, optional): whether you would like to refresh before retreiving the coordinates.</span>
<span class="sd">             Defaults to False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">v</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_device_info</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;latlong&#39;</span><span class="p">,</span> <span class="n">refresh</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;latlong&#39;</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_device_indoor_location</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">refresh</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the indoor location of a targeted device.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the device or interaction URN.</span>
<span class="sd">            refresh (bool, optional): whether you would like to refresh before retrieving the location.</span>
<span class="sd">             Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: the indoor location of the device.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">v</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_device_info</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;indoor_location&#39;</span><span class="p">,</span> <span class="n">refresh</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;indoor_location&#39;</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_device_battery</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">refresh</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the battery of a targeted device.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the device or interaction URN.</span>
<span class="sd">            refresh (bool, optional): whether you would like to refresh before retrieving the battery.</span>
<span class="sd">             Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: the battery of the device.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">v</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_device_info</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;battery&#39;</span><span class="p">,</span> <span class="n">refresh</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;battery&#39;</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_device_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the device type of a targeted device, i.e. gen 2, gen 3, etc.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the device or interaction URN.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: the device type.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">v</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_device_info</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_device_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the ID of a targeted device.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the device or interaction URN.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: the device ID.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">v</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_device_info</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_user_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the user profile of a targeted device.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the device or interaction URN.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: the user profile registered to the device.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">v</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_device_info</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;username&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_device_location_enabled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns whether the location services on a device are enabled.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the device or interaction URN.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: &#39;true&#39; if the device&#39;s location services are enabled, &#39;false&#39; otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">v</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_device_info</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;location_enabled&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;location_enabled&#39;</span><span class="p">]</span>

    <span class="c1"># target can have only one item</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">_get_device_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">refresh</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Used privately by device information functions to retrieve varying information</span>
<span class="sd">         on the device, such as the ID, location, battery, name and type.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the device or interaction URN.</span>
<span class="sd">            query (str): which category of information you are retrieving.</span>
<span class="sd">            refresh (bool): whether to refresh before retrieving information on the device.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: information on the device based on the query.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_get_device_info_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
            <span class="s1">&#39;query&#39;</span><span class="p">:</span> <span class="n">query</span><span class="p">,</span>
            <span class="s1">&#39;refresh&#39;</span><span class="p">:</span> <span class="n">refresh</span>
        <span class="p">}</span>
        <span class="n">v</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">set_device_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets the name of a targeted device and updates it on the Relay Dash.</span>
<span class="sd">        The name remains updated until it is set again via a workflow or updated manually</span>
<span class="sd">        on the Relay Dash.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the device or interaction URN.</span>
<span class="sd">            name (str): a new name for your device.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_device_info</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

    <span class="c1"># set_device_channel is currently not supported</span>
    <span class="c1"># async def set_device_channel(self, target, channel: str):</span>
    <span class="c1">#     &quot;&quot;&quot;Sets the channel of a targeted device and updates it on the Relay Dash.</span>
    <span class="c1">#     The new channel remains until it is set again via a workflow or updated on the</span>
    <span class="c1">#     Relay Dash.</span>
    <span class="c1">#</span>
    <span class="c1">#     Args:</span>
    <span class="c1">#         target (str): the device or interaction URN.</span>
    <span class="c1">#         channel (str): the channel that you would like to update your device to.</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     await self._set_device_info(target, &#39;channel&#39;, channel)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">enable_location</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Enables location services on a device.  Location services will remain</span>
<span class="sd">        enabled until they are disabled on the Relay Dash or through a workflow.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the device or interaction URN.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_device_info</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;location_enabled&#39;</span><span class="p">,</span> <span class="s1">&#39;true&#39;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">disable_location</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Disables location services on a device.  Location services will remain</span>
<span class="sd">        disabled until they are enabled on the Relay Dash or through a workflow.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the device or interaction URN.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_device_info</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;location_enabled&#39;</span><span class="p">,</span> <span class="s1">&#39;false&#39;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_set_device_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Used privately by device information functions to set information</span>
<span class="sd">        fields on the device, such as the location, name, and channel of</span>
<span class="sd">        the device.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the device or interaction URN. This can only have one item.</span>
<span class="sd">            field (str): the type of information you would like to set, such as the &#39;name&#39;, &#39;channel&#39;, etc.</span>
<span class="sd">            value (str): the new value of the field.</span>

<span class="sd">        Returns:</span>
<span class="sd">            an event containing the updated device information.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_set_device_info_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
            <span class="s1">&#39;field&#39;</span><span class="p">:</span> <span class="n">field</span><span class="p">,</span>
            <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">value</span>
        <span class="p">}</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">event</span>

    <span class="c1"># set_device_mode is currently not supported</span>
    <span class="c1"># async def set_device_mode(self, target, mode:str=&#39;none&#39;):</span>
    <span class="c1">#     &quot;&quot;&quot;Sets the mode of the device.</span>
    <span class="c1">#</span>
    <span class="c1">#     Args:</span>
    <span class="c1">#         target (str): the device or interaction URN.</span>
    <span class="c1">#         mode (str, optional): the updated mode of the device, which can be &#39;panic&#39;, &#39;alarm&#39;, or &#39;none&#39;.</span>
    <span class="c1">#         Defaults to &#39;none&#39;.</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     event = {</span>
    <span class="c1">#         &#39;_type&#39;: &#39;wf_api_set_device_channel_request&#39;,</span>
    <span class="c1">#         &#39;target&#39;: target,</span>
    <span class="c1">#         &#39;mode&#39;: mode,</span>
    <span class="c1">#     }</span>
    <span class="c1">#     await self._send_receive(event)</span>
    <span class="c1">#     # await self._set_device_info(target, )</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">led_info</span><span class="p">(</span><span class="n">rotations</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">duration</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">repeat_delay</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">pattern_repeats</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets information on a device, such as the number of rotations, count, duration, repeat delay,</span>
<span class="sd">        pattern repeats, and colors.</span>

<span class="sd">        Args:</span>
<span class="sd">            rotations (int, optional): number of rotations. Defaults to None.</span>
<span class="sd">            count (int, optional): the number of times the LEDs will perform an action. Defaults to None.</span>
<span class="sd">            duration (int, optional): duration of the LED action in milliseconds. Defaults to None.</span>
<span class="sd">            repeat_delay (int, optional): the length of delay in milliseconds. Defaults to None.</span>
<span class="sd">            pattern_repeats (_type_, optional): the number of times a pattern should repeat. Defaults to None.</span>
<span class="sd">            colors (_type_, optional): hex-code of the color for the LEDs. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            information field that was set on the LEDs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">rotations</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">info</span><span class="p">[</span><span class="s1">&#39;rotations&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rotations</span>
        <span class="k">if</span> <span class="n">count</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">info</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">count</span>
        <span class="k">if</span> <span class="n">duration</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">info</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">duration</span>
        <span class="k">if</span> <span class="n">repeat_delay</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">info</span><span class="p">[</span><span class="s1">&#39;repeat_delay&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">repeat_delay</span>
        <span class="k">if</span> <span class="n">pattern_repeats</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">info</span><span class="p">[</span><span class="s1">&#39;pattern_repeats&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pattern_repeats</span>
        <span class="k">if</span> <span class="n">colors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">info</span><span class="p">[</span><span class="s1">&#39;colors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">colors</span>
        <span class="k">return</span> <span class="n">info</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">led_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">effect</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;flash&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Private method used for performing actions on the LEDs, such as creating </span>
<span class="sd">        a rainbow, flashing, rotating, etc.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the interaction URN.</span>
<span class="sd">            effect (str, optional): effect to perform on LEDs, can be &#39;rainbow&#39;, &#39;rotate&#39;, &#39;flash&#39;, &#39;breath&#39;,</span>
<span class="sd">                &#39;static&#39;, or &#39;off&#39;. Defaults to &#39;flash&#39;.</span>
<span class="sd">            args (optional): use led_info() to create args. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_set_led_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
            <span class="s1">&#39;effect&#39;</span><span class="p">:</span> <span class="n">effect</span><span class="p">,</span>
            <span class="s1">&#39;args&#39;</span><span class="p">:</span> <span class="n">args</span>
        <span class="p">}</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">switch_all_led_on</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;0000ff&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Switches all the LEDs on a device on to a specified color.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the interaction URN.</span>
<span class="sd">            color (str, optional): the hex color code you would like the LEDs to be. Defaults to &#39;0000ff&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">led_action</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;static&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;ring&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">}})</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">switch_led_on</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;0000ff&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Switches on an LED at a particular index to a specified color.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the interaction URN.</span>
<span class="sd">            index (int): the index of an LED, numbered 1-12.</span>
<span class="sd">            color (str, optional): the hex color code you would like to turn the LED to. Defaults to &#39;0000ff&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">led_action</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;static&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="p">{</span><span class="n">index</span><span class="p">:</span> <span class="n">color</span><span class="p">}})</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">rainbow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">rotations</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Switches all the LEDs on to a configured rainbow pattern and rotates the rainbow</span>
<span class="sd">        a specified number of times.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the interaction URN.</span>
<span class="sd">            rotations (int, optional): the number of times you would like the rainbow to rotate. Defaults to -1,</span>
<span class="sd">             meaning the rainbow will rotate indefinitely.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">led_action</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;rainbow&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;rotations&#39;</span><span class="p">:</span> <span class="n">rotations</span><span class="p">})</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">flash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;0000ff&#39;</span><span class="p">,</span> <span class="n">count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Switches all the LEDs on a device to a certain color and flashes them</span>
<span class="sd">        a specified number of times.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the interaction URN.</span>
<span class="sd">            color (str, optional): the hex color code you would like to turn the LEDs to. Defaults to &#39;0000ff&#39;.</span>
<span class="sd">            count (int, optional): the number of times you would like the LEDs to flash. Defaults to -1, meaning</span>
<span class="sd">             the LEDs will flash indefinitely.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">led_action</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;flash&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;ring&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">},</span> <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="n">count</span><span class="p">})</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">breathe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;0000ff&#39;</span><span class="p">,</span> <span class="n">count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Switches all the LEDs on a device to a certain color and creates a &#39;breathing&#39; effect,</span>
<span class="sd">        where the LEDs will slowly light up a specified number of times.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the interaction URN.</span>
<span class="sd">            color (str, optional): the hex color code you would like to turn the LEDs to. Defaults to &#39;0000ff&#39;.</span>
<span class="sd">            count (int, optional): the number of times you would like the LEDs to &#39;breathe&#39;. Defaults to -1, meaning</span>
<span class="sd">            the LEDs will &#39;breathe&#39; indefinitely.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">led_action</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;breathe&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;ring&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">},</span> <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="n">count</span><span class="p">})</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;0000ff&#39;</span><span class="p">,</span> <span class="n">rotations</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Switches all the LEDs on a device to a certain color and rotates them a specified number</span>
<span class="sd">        of times.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the interaction URN.</span>
<span class="sd">            color (str, optional): the hex color code you would like to turn the LEDs to. Defaults to &#39;0000ff&#39;.</span>
<span class="sd">            rotations (int, optional): the number of times you would like the LEDs to rotate. Defaults to -1, meaning</span>
<span class="sd">            the LEDs will rotate indefinitely.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">led_action</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;rotate&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;1&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">},</span> <span class="s1">&#39;rotations&#39;</span><span class="p">:</span> <span class="n">rotations</span><span class="p">})</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">switch_all_led_off</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Switches all the LEDs on a device off.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the interaction URN.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">led_action</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;off&#39;</span><span class="p">,</span> <span class="p">{})</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">vibrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">pattern</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Makes the device vibrate in a particular pattern.  You can specify</span>
<span class="sd">        how many vibrations you would like, the duration of each vibration in</span>
<span class="sd">        milliseconds, and how long you would like the pauses between each vibration to last</span>
<span class="sd">        in milliseconds.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the interaction URN.</span>
<span class="sd">            pattern (list, optional): an array representing the pattern of your vibration. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">pattern</span><span class="p">:</span>
            <span class="n">pattern</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">]</span>

        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_vibrate_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
            <span class="s1">&#39;pattern&#39;</span><span class="p">:</span> <span class="n">pattern</span>
        <span class="p">}</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">start_timer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">60</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Starts an unnamed timer, meaning this will be the only timer on your device.</span>
<span class="sd">        The timer will fire when it reaches the value of the &#39;timeout&#39; parameter.</span>

<span class="sd">        Args:</span>
<span class="sd">            timeout (int): the number of seconds you would like to wait until the timer fires.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_start_timer_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;timeout&#39;</span><span class="p">:</span> <span class="n">timeout</span>
        <span class="p">}</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">stop_timer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stops an unnamed timer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_stop_timer_request&#39;</span>
        <span class="p">}</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">terminate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Terminates a workflow.  This method is usually called</span>
<span class="sd">        after your workflow has completed, and you would like to end the</span>
<span class="sd">        workflow by calling end_interaction(), where you can then terminate</span>
<span class="sd">        the workflow.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_terminate_request&#39;</span>
        <span class="p">}</span>
        <span class="c1"># there is no response</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">create_incident</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">originator</span><span class="p">,</span> <span class="n">itype</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates an incident that will alert the Relay Dash.</span>

<span class="sd">        Args:</span>
<span class="sd">            originator (str): the device URN that triggered the incident.</span>
<span class="sd">            itype (str): the type of incident that occurred.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: the incident ID.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO: what are the values for itype?</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_create_incident_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">itype</span><span class="p">,</span>
            <span class="s1">&#39;originator_uri&#39;</span><span class="p">:</span> <span class="n">originator</span>
        <span class="p">}</span>
        <span class="n">v</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;incident_id&#39;</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">resolve_incident</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">incident_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">reason</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Resolves an incident that was created.</span>

<span class="sd">        Args:</span>
<span class="sd">            incident_id (str): the ID of the incident you would like to resolve.</span>
<span class="sd">            reason (str): the reason for resolving the incident.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_resolve_incident_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;incident_id&#39;</span><span class="p">:</span> <span class="n">incident_id</span><span class="p">,</span>
            <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="n">reason</span>
        <span class="p">}</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="c1"># restart/powering down device is currently not supported</span>

    <span class="c1"># async def restart_device(self, target):</span>
    <span class="c1">#     &quot;&quot;&quot;Restarts a device during a workflow, without having</span>
    <span class="c1">#     to physically restart the device via holding down the &#39;-&#39; button.</span>
    <span class="c1">#</span>
    <span class="c1">#     Args:</span>
    <span class="c1">#         target (str): the URN of the device you would like to restart.</span>
    <span class="c1">#     &quot;&quot;&quot;</span>

    <span class="c1">#     event = {</span>
    <span class="c1">#         &#39;_type&#39;: &#39;wf_api_device_power_off_request&#39;,</span>
    <span class="c1">#         &#39;_target&#39;: self.targets_from_source_uri(target),</span>
    <span class="c1">#         &#39;restart&#39;: True</span>
    <span class="c1">#     }</span>
    <span class="c1">#     await self._send_receive(event)</span>

    <span class="c1"># async def power_down_device(self, target):</span>
    <span class="c1">#     &quot;&quot;&quot;Powers down a device during a workflow, without</span>
    <span class="c1">#     having to physically power down the device via holding down the &#39;+&#39; button.</span>
    <span class="c1">#</span>
    <span class="c1">#     Args:</span>
    <span class="c1">#         target (str): the URN of the device that you would like to power down.</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     event = {</span>
    <span class="c1">#         &#39;_type&#39;: &#39;wf_api_device_power_off_request&#39;,</span>
    <span class="c1">#         &#39;_target&#39;: self.targets_from_source_uri(target),</span>
    <span class="c1">#         &#39;restart&#39;: False</span>
    <span class="c1">#     }</span>
    <span class="c1">#     await self._send_receive(event)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">stop_playback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">pb_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">event</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">pb_id</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_stop_playback_request&#39;</span><span class="p">,</span>
                <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
                <span class="s1">&#39;ids&#39;</span><span class="p">:</span> <span class="n">pb_id</span>
            <span class="p">}</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">pb_id</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">pb_id</span> <span class="o">=</span> <span class="p">[</span><span class="n">pb_id</span><span class="p">]</span>
            <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_stop_playback_request&#39;</span><span class="p">,</span>
                <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
                <span class="s1">&#39;ids&#39;</span><span class="p">:</span> <span class="n">pb_id</span>
            <span class="p">}</span>
        <span class="k">elif</span> <span class="n">pb_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_stop_playback_request&#39;</span><span class="p">,</span>
                <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">from_lang</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;en-US&#39;</span><span class="p">,</span> <span class="n">to_lang</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;es-ES&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Translates text from one language to another.</span>

<span class="sd">        Args:</span>
<span class="sd">            text (str): the text that you would like to translate.</span>
<span class="sd">            from_lang (str): the language that you would like to translate from.</span>
<span class="sd">            to_lang (str): the language that you would like to translate to.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: the translated text.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_translate_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="n">text</span><span class="p">,</span>
            <span class="s1">&#39;from_lang&#39;</span><span class="p">:</span> <span class="n">from_lang</span><span class="p">,</span>
            <span class="s1">&#39;to_lang&#39;</span><span class="p">:</span> <span class="n">to_lang</span>
        <span class="p">}</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span>

    <span class="c1"># target can have only one item</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">place_call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">callee_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Places a call to another device.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the device which will place the call.</span>
<span class="sd">            callee_uri (str): the URN of the device you would like to call.</span>

<span class="sd">        Returns:</span>
<span class="sd">            the event response.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_call_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
            <span class="s1">&#39;uri&#39;</span><span class="p">:</span> <span class="n">callee_uri</span>
        <span class="p">}</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;call_id&#39;</span><span class="p">]</span>

    <span class="c1"># target can have only one item</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">answer_call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">call_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Answers an incoming call on your device.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the device which will answer the call.</span>
<span class="sd">            call_id (str): the ID of the call to answer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_answer_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
            <span class="s1">&#39;call_id&#39;</span><span class="p">:</span> <span class="n">call_id</span>
        <span class="p">}</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="c1"># target can have only one item</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">hangup_call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">call_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Ends (hangs up) a call on a device.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the device which will do the hangup.</span>
<span class="sd">            call_id (str): the call ID.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_hangup_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
            <span class="s1">&#39;call_id&#39;</span><span class="p">:</span> <span class="n">call_id</span>
        <span class="p">}</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_group_members</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the members of a particular group.</span>

<span class="sd">        Args:</span>
<span class="sd">            group_uri (str): the URN of the group that you would like to retrieve members from.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str[]: a list of the members within the specified group.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_group_query_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;query&#39;</span><span class="p">:</span> <span class="s1">&#39;list_members&#39;</span><span class="p">,</span>
            <span class="s1">&#39;group_uri&#39;</span><span class="p">:</span> <span class="n">group_uri</span>
        <span class="p">}</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;member_uris&#39;</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">is_group_member</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group_name_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">potential_member_name_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Checks whether a device is a member of a particular group.</span>

<span class="sd">        Args:</span>
<span class="sd">            group_name_uri (str): the URN of a group.</span>
<span class="sd">            potential_member_name_uri: the URN of the device name.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: &#39;true&#39; if the device is a member of the specified group, &#39;false&#39; otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">this_group_name</span> <span class="o">=</span> <span class="n">parse_group_name</span><span class="p">(</span><span class="n">group_name_uri</span><span class="p">)</span>
        <span class="n">this_device_name</span> <span class="o">=</span> <span class="n">parse_device_name</span><span class="p">(</span><span class="n">potential_member_name_uri</span><span class="p">)</span>
        <span class="n">this_group_uri</span> <span class="o">=</span> <span class="n">group_member</span><span class="p">(</span><span class="n">this_group_name</span><span class="p">,</span> <span class="n">this_device_name</span><span class="p">)</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_group_query_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;query&#39;</span><span class="p">:</span> <span class="s1">&#39;is_member&#39;</span><span class="p">,</span>
            <span class="s1">&#39;group_uri&#39;</span><span class="p">:</span> <span class="n">this_group_uri</span>
        <span class="p">}</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;is_member&#39;</span><span class="p">]</span>

    <span class="c1"># target can have only one item</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">set_user_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets the profile of a user by updating the username.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the device URN whose profile you would like to update.</span>
<span class="sd">            username (str): the updated username for the device.</span>
<span class="sd">            force (bool, optional): whether you would like to force this update. Defaults to False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_set_user_profile_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
            <span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="n">username</span><span class="p">,</span>
            <span class="s1">&#39;force&#39;</span><span class="p">:</span> <span class="n">force</span>
        <span class="p">}</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="c1"># target can have only one item</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_unread_inbox_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieves the number of messages in a device&#39;s inbox.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the device or interaction URN whose inbox you would like to check.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: the number of messages in the specified device&#39;s inbox.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_inbox_count_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">play_unread_inbox_messages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Play a targeted device&#39;s inbox messages.</span>

<span class="sd">        Args:</span>
<span class="sd">            target (str): the device or interaction URN whose inbox messages you would like to play.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_play_inbox_messages_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">log_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">category</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="n">content_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;text/plain&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Log an analytics event from a workflow with the specified content and</span>
<span class="sd">        under a specified category. This does not log the device who</span>
<span class="sd">        triggered the workflow that called this function.</span>

<span class="sd">        Args:</span>
<span class="sd">            message (str): a description for your analytical event.</span>
<span class="sd">            category (str, optional): a category for your analytical event. Defaults to &#39;default&#39;.</span>
<span class="sd">            target (str, optional): URN of the device that triggered this function. Defaults to None.</span>
<span class="sd">            content_type (str, optional): encoding of the message string. Defaults to &#39;text/plain&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_log_analytics_event_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="n">message</span><span class="p">,</span>
            <span class="s1">&#39;content_type&#39;</span><span class="p">:</span> <span class="n">content_type</span><span class="p">,</span>
            <span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="n">category</span><span class="p">,</span>
            <span class="s1">&#39;device_uri&#39;</span><span class="p">:</span> <span class="n">target</span>
        <span class="p">}</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">log_user_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">category</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Log an analytic event from a workflow with the specified content and</span>
<span class="sd">        under a specified category.  This includes the device who triggered the workflow</span>
<span class="sd">        that called this function.</span>

<span class="sd">        Args:</span>
<span class="sd">            message (str): a description for your analytical event.</span>
<span class="sd">            target (str, optional): the URN of a the device that triggered this function. Defaults to None.</span>
<span class="sd">            category (str): a category for your analytical event.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_log_analytics_event_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="n">message</span><span class="p">,</span>
            <span class="s1">&#39;content_type&#39;</span><span class="p">:</span> <span class="s1">&#39;text/plain&#39;</span><span class="p">,</span>
            <span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="n">category</span><span class="p">,</span>
            <span class="s1">&#39;device_uri&#39;</span><span class="p">:</span> <span class="n">target</span>
        <span class="p">}</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">set_timer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">timer_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;timeout&#39;</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span> <span class="n">timeout_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;secs&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Serves as a named timer that can be either interval or timeout.  Allows you to specify</span>
<span class="sd">        the unit of time.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): a name for your timer.</span>
<span class="sd">            timer_type (str, optional): can be &#39;timeout&#39; or &#39;interval&#39;. Defaults to &#39;timeout&#39;.</span>
<span class="sd">            timeout (int): an integer representing when you would like your timer to fire.</span>
<span class="sd">            timeout_type (str, optional): can be &#39;ms&#39;, &#39;secs&#39;, &#39;mins&#39; or &#39;hrs&#39;. Defaults to &#39;secs&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_set_timer_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">timer_type</span><span class="p">,</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
            <span class="s1">&#39;timeout&#39;</span><span class="p">:</span> <span class="n">timeout</span><span class="p">,</span>
            <span class="s1">&#39;timeout_type&#39;</span><span class="p">:</span> <span class="n">timeout_type</span>
        <span class="p">}</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">clear_timer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clears the specified timer.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): the name of the timer that you would like to clear.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_clear_timer_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span>
        <span class="p">}</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">sms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stype</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_sms_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">stype</span><span class="p">,</span>
            <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="n">text</span><span class="p">,</span>
            <span class="s1">&#39;uri&#39;</span><span class="p">:</span> <span class="n">uri</span>
        <span class="p">}</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;message_id&#39;</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">enable_home_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_home_channel_state</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">disable_home_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_home_channel_state</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_set_home_channel_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">enabled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_set_home_channel_state_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
            <span class="s1">&#39;enabled&#39;</span><span class="p">:</span> <span class="n">enabled</span>
        <span class="p">}</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="c1"># target can have only one item</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">register</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">expires</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_register_request&#39;</span><span class="p">,</span>
            <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
            <span class="s1">&#39;uri&#39;</span><span class="p">:</span> <span class="n">uri</span><span class="p">,</span>
            <span class="s1">&#39;password&#39;</span><span class="p">:</span> <span class="n">password</span><span class="p">,</span>
            <span class="s1">&#39;expires&#39;</span><span class="p">:</span> <span class="n">expires</span>
        <span class="p">}</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="c1"># invalid_type and missing_type are just for internal testing of error handling</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_invalid_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_mkinard_breakage&#39;</span><span class="p">,</span>
            <span class="s1">&#39;device_id&#39;</span><span class="p">:</span> <span class="s1">&#39;TheQuickBrownFoxJumpedOverTheLazyDog&#39;</span><span class="p">,</span>
            <span class="s1">&#39;call_id&#39;</span><span class="p">:</span> <span class="s1">&#39;you can</span><span class="se">\&#39;</span><span class="s1">t catch me&#39;</span>
        <span class="p">}</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_missing_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;device_id&#39;</span><span class="p">:</span> <span class="s1">&#39;NowIsTheTimeForAllGoodMenToComeToTheAidOfYourCountry&#39;</span><span class="p">,</span>
            <span class="s1">&#39;call_id&#39;</span><span class="p">:</span> <span class="s1">&#39;you can</span><span class="se">\&#39;</span><span class="s1">t catch me&#39;</span>
        <span class="p">}</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">workflow</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initializes workflow fields.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>workflow</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="relay.workflow.Workflow" href="#relay.workflow.Workflow">Workflow</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>your workflow.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">workflow</span><span class="p">:</span> <span class="n">Workflow</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes workflow fields.</span>

<span class="sd">    Args:</span>
<span class="sd">        workflow (Workflow): your workflow.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">workflow</span> <span class="o">=</span> <span class="n">workflow</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">websocket</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">id_futures</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># {_id: future}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">event_futures</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.alert" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">alert</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">originator</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">push_opts</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Sends out an alert to the specified group of devices and the Relay Dash.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target(str)</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the group URN that you would like to send an alert to.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>originator</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the URN of the device that triggered the alert.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>a name for your alert.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>text</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the text that you would like to be spoken to the group as your alert.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>push_opts</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>push options for if the alert is sent to the Relay app on a virtual device.
Defaults to an empty value.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">alert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">originator</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">push_opts</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sends out an alert to the specified group of devices and the Relay Dash.</span>

<span class="sd">    Args:</span>
<span class="sd">        target(str): the group URN that you would like to send an alert to.</span>
<span class="sd">        originator (str): the URN of the device that triggered the alert.</span>
<span class="sd">        name (str): a name for your alert.</span>
<span class="sd">        text (str): the text that you would like to be spoken to the group as your alert.</span>
<span class="sd">        push_opts (dict, optional): push options for if the alert is sent to the Relay app on a virtual device.</span>
<span class="sd">         Defaults to an empty value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">push_opts</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">push_opts</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_notification</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">originator</span><span class="p">,</span> <span class="s1">&#39;alert&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">push_opts</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.answer_call" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">answer_call</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">call_id</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Answers an incoming call on your device.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device which will answer the call.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>call_id</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the ID of the call to answer.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">answer_call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">call_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Answers an incoming call on your device.</span>

<span class="sd">    Args:</span>
<span class="sd">        target (str): the device which will answer the call.</span>
<span class="sd">        call_id (str): the ID of the call to answer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_answer_request&#39;</span><span class="p">,</span>
        <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
        <span class="s1">&#39;call_id&#39;</span><span class="p">:</span> <span class="n">call_id</span>
    <span class="p">}</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.breathe" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">breathe</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0000ff&#39;</span><span class="p">,</span> <span class="n">count</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Switches all the LEDs on a device to a certain color and creates a 'breathing' effect,
where the LEDs will slowly light up a specified number of times.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the interaction URN.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>color</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the hex color code you would like to turn the LEDs to. Defaults to '0000ff'.</p>
            </div>
          </td>
          <td>
                <code>&#39;0000ff&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>count</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the number of times you would like the LEDs to 'breathe'. Defaults to -1, meaning</p>
            </div>
          </td>
          <td>
                <code>-1</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">breathe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;0000ff&#39;</span><span class="p">,</span> <span class="n">count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Switches all the LEDs on a device to a certain color and creates a &#39;breathing&#39; effect,</span>
<span class="sd">    where the LEDs will slowly light up a specified number of times.</span>

<span class="sd">    Args:</span>
<span class="sd">        target (str): the interaction URN.</span>
<span class="sd">        color (str, optional): the hex color code you would like to turn the LEDs to. Defaults to &#39;0000ff&#39;.</span>
<span class="sd">        count (int, optional): the number of times you would like the LEDs to &#39;breathe&#39;. Defaults to -1, meaning</span>
<span class="sd">        the LEDs will &#39;breathe&#39; indefinitely.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">led_action</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;breathe&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;ring&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">},</span> <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="n">count</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.broadcast" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">broadcast</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">originator</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">push_opts</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Sends out a broadcast message to a group of devices.  The message is played out on
all devices, as well as sent to the Relay Dash.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target(str)</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the group URN that you would like to broadcast your message to.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>originator</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device URN that triggered the broadcast.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>a name for your broadcast.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>text</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the text that you would like to be broadcasted to your group.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>push_opts</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>push options for if the broadcast is sent to the Relay app on a virtual
device. Defaults to an empty value.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">broadcast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">originator</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">push_opts</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sends out a broadcast message to a group of devices.  The message is played out on</span>
<span class="sd">    all devices, as well as sent to the Relay Dash.</span>

<span class="sd">    Args:</span>
<span class="sd">        target(str): the group URN that you would like to broadcast your message to.</span>
<span class="sd">        originator (str): the device URN that triggered the broadcast.</span>
<span class="sd">        name (str): a name for your broadcast.</span>
<span class="sd">        text (str): the text that you would like to be broadcasted to your group.</span>
<span class="sd">        push_opts (dict, optional): push options for if the broadcast is sent to the Relay app on a virtual</span>
<span class="sd">         device. Defaults to an empty value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">push_opts</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">push_opts</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_notification</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">originator</span><span class="p">,</span> <span class="s1">&#39;broadcast&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">push_opts</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.cancel_alert" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">cancel_alert</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Cancels an alert that was sent to a group of devices.  Particularly useful if you would like to cancel
 the alert on all devices after one device has acknowledged the alert.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target(str)</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device URN that has acknowledged the alert.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the name of the alert.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">cancel_alert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cancels an alert that was sent to a group of devices.  Particularly useful if you would like to cancel</span>
<span class="sd">     the alert on all devices after one device has acknowledged the alert.</span>

<span class="sd">    Args:</span>
<span class="sd">        target(str): the device URN that has acknowledged the alert.</span>
<span class="sd">        name (str): the name of the alert.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_notification</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;cancel&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.cancel_broadcast" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">cancel_broadcast</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Cancels the broadcast that was sent to a group of devices.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target(str)</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device URN that is cancelling the broadcast.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the name of the broadcast that you would like to cancel.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">cancel_broadcast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cancels the broadcast that was sent to a group of devices.</span>

<span class="sd">    Args:</span>
<span class="sd">        target(str): the device URN that is cancelling the broadcast.</span>
<span class="sd">        name (str): the name of the broadcast that you would like to cancel.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_notification</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;cancel&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.clear_timer" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">clear_timer</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Clears the specified timer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the name of the timer that you would like to clear.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2094</span>
<span class="normal">2095</span>
<span class="normal">2096</span>
<span class="normal">2097</span>
<span class="normal">2098</span>
<span class="normal">2099</span>
<span class="normal">2100</span>
<span class="normal">2101</span>
<span class="normal">2102</span>
<span class="normal">2103</span>
<span class="normal">2104</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">clear_timer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Clears the specified timer.</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): the name of the timer that you would like to clear.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_clear_timer_request&#39;</span><span class="p">,</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span>
    <span class="p">}</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.create_incident" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">create_incident</span><span class="p">(</span><span class="n">originator</span><span class="p">,</span> <span class="n">itype</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Creates an incident that will alert the Relay Dash.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>originator</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device URN that triggered the incident.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>itype</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the type of incident that occurred.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the incident ID.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">create_incident</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">originator</span><span class="p">,</span> <span class="n">itype</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates an incident that will alert the Relay Dash.</span>

<span class="sd">    Args:</span>
<span class="sd">        originator (str): the device URN that triggered the incident.</span>
<span class="sd">        itype (str): the type of incident that occurred.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: the incident ID.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO: what are the values for itype?</span>
    <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_create_incident_request&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">itype</span><span class="p">,</span>
        <span class="s1">&#39;originator_uri&#39;</span><span class="p">:</span> <span class="n">originator</span>
    <span class="p">}</span>
    <span class="n">v</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;incident_id&#39;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.disable_location" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">disable_location</span><span class="p">(</span><span class="n">target</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Disables location services on a device.  Location services will remain
disabled until they are enabled on the Relay Dash or through a workflow.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device or interaction URN.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">disable_location</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Disables location services on a device.  Location services will remain</span>
<span class="sd">    disabled until they are enabled on the Relay Dash or through a workflow.</span>

<span class="sd">    Args:</span>
<span class="sd">        target (str): the device or interaction URN.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_device_info</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;location_enabled&#39;</span><span class="p">,</span> <span class="s1">&#39;false&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.enable_location" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">enable_location</span><span class="p">(</span><span class="n">target</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Enables location services on a device.  Location services will remain
enabled until they are disabled on the Relay Dash or through a workflow.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device or interaction URN.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">enable_location</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Enables location services on a device.  Location services will remain</span>
<span class="sd">    enabled until they are disabled on the Relay Dash or through a workflow.</span>

<span class="sd">    Args:</span>
<span class="sd">        target (str): the device or interaction URN.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_device_info</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;location_enabled&#39;</span><span class="p">,</span> <span class="s1">&#39;true&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.end_interaction" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">end_interaction</span><span class="p">(</span><span class="n">target</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Ends an interaction with the user.  Triggers an INTERACTION_ENDED event to signify
that the user is done interacting with the device.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target(str)</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the interaction that you would like to end.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">end_interaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Ends an interaction with the user.  Triggers an INTERACTION_ENDED event to signify</span>
<span class="sd">    that the user is done interacting with the device.</span>

<span class="sd">    Args:</span>
<span class="sd">        target(str): the interaction that you would like to end.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_end_interaction_request&#39;</span><span class="p">,</span>
        <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.flash" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">flash</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0000ff&#39;</span><span class="p">,</span> <span class="n">count</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Switches all the LEDs on a device to a certain color and flashes them
a specified number of times.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the interaction URN.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>color</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the hex color code you would like to turn the LEDs to. Defaults to '0000ff'.</p>
            </div>
          </td>
          <td>
                <code>&#39;0000ff&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>count</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the number of times you would like the LEDs to flash. Defaults to -1, meaning
the LEDs will flash indefinitely.</p>
            </div>
          </td>
          <td>
                <code>-1</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">flash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;0000ff&#39;</span><span class="p">,</span> <span class="n">count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Switches all the LEDs on a device to a certain color and flashes them</span>
<span class="sd">    a specified number of times.</span>

<span class="sd">    Args:</span>
<span class="sd">        target (str): the interaction URN.</span>
<span class="sd">        color (str, optional): the hex color code you would like to turn the LEDs to. Defaults to &#39;0000ff&#39;.</span>
<span class="sd">        count (int, optional): the number of times you would like the LEDs to flash. Defaults to -1, meaning</span>
<span class="sd">         the LEDs will flash indefinitely.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">led_action</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;flash&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;ring&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">},</span> <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="n">count</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.get_device_address" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_device_address</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">refresh</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns the address of a targeted device.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device or interaction URN.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>refresh</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>whether you would like to refresh before retrieving the address.
Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the address of the device.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">get_device_address</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">refresh</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the address of a targeted device.</span>

<span class="sd">    Args:</span>
<span class="sd">        target (str): the device or interaction URN.</span>
<span class="sd">        refresh (bool, optional): whether you would like to refresh before retrieving the address.</span>
<span class="sd">         Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: the address of the device.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_device_location</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">refresh</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.get_device_battery" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_device_battery</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">refresh</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns the battery of a targeted device.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device or interaction URN.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>refresh</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>whether you would like to refresh before retrieving the battery.
Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>int</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the battery of the device.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">get_device_battery</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">refresh</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the battery of a targeted device.</span>

<span class="sd">    Args:</span>
<span class="sd">        target (str): the device or interaction URN.</span>
<span class="sd">        refresh (bool, optional): whether you would like to refresh before retrieving the battery.</span>
<span class="sd">         Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: the battery of the device.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">v</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_device_info</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;battery&#39;</span><span class="p">,</span> <span class="n">refresh</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;battery&#39;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.get_device_coordinates" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_device_coordinates</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">refresh</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Retrieves the coordinates of the device's location.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device or interaction URN.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>refresh</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>whether you would like to refresh before retreiving the coordinates.
Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">get_device_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">refresh</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieves the coordinates of the device&#39;s location.</span>

<span class="sd">    Args:</span>
<span class="sd">        target (str): the device or interaction URN.</span>
<span class="sd">        refresh (bool, optional): whether you would like to refresh before retreiving the coordinates.</span>
<span class="sd">         Defaults to False.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">v</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_device_info</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;latlong&#39;</span><span class="p">,</span> <span class="n">refresh</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;latlong&#39;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.get_device_id" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_device_id</span><span class="p">(</span><span class="n">target</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns the ID of a targeted device.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device or interaction URN.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device ID.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">get_device_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the ID of a targeted device.</span>

<span class="sd">    Args:</span>
<span class="sd">        target (str): the device or interaction URN.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: the device ID.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">v</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_device_info</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.get_device_indoor_location" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_device_indoor_location</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">refresh</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns the indoor location of a targeted device.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device or interaction URN.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>refresh</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>whether you would like to refresh before retrieving the location.
Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the indoor location of the device.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">get_device_indoor_location</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">refresh</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the indoor location of a targeted device.</span>

<span class="sd">    Args:</span>
<span class="sd">        target (str): the device or interaction URN.</span>
<span class="sd">        refresh (bool, optional): whether you would like to refresh before retrieving the location.</span>
<span class="sd">         Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: the indoor location of the device.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">v</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_device_info</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;indoor_location&#39;</span><span class="p">,</span> <span class="n">refresh</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;indoor_location&#39;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.get_device_latlong" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_device_latlong</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">refresh</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns the latitude and longitude coordinates of a targeted device.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device or interaction URN.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>refresh</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>whether you would like to refresh before retrieving the coordinates.
Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>float[]: an array containing the latitude and longitude of the device.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">get_device_latlong</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">refresh</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the latitude and longitude coordinates of a targeted device.</span>

<span class="sd">    Args:</span>
<span class="sd">        target (str): the device or interaction URN.</span>
<span class="sd">        refresh (bool, optional): whether you would like to refresh before retrieving the coordinates.</span>
<span class="sd">         Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float[]: an array containing the latitude and longitude of the device.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_device_coordinates</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">refresh</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.get_device_location" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_device_location</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">refresh</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns the location of a targeted device.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device or interaction URN.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>refresh</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>whether you would like to refresh before retrieving the location.
Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the location of the device.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">get_device_location</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">refresh</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the location of a targeted device.</span>

<span class="sd">    Args:</span>
<span class="sd">        target (str): the device or interaction URN.</span>
<span class="sd">        refresh (bool, optional): whether you would like to refresh before retrieving the location.</span>
<span class="sd">         Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: the location of the device.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">v</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_device_info</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;address&#39;</span><span class="p">,</span> <span class="n">refresh</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;address&#39;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.get_device_location_enabled" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_device_location_enabled</span><span class="p">(</span><span class="n">target</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns whether the location services on a device are enabled.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device or interaction URN.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>'true' if the device's location services are enabled, 'false' otherwise.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">get_device_location_enabled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns whether the location services on a device are enabled.</span>

<span class="sd">    Args:</span>
<span class="sd">        target (str): the device or interaction URN.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: &#39;true&#39; if the device&#39;s location services are enabled, &#39;false&#39; otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">v</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_device_info</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;location_enabled&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;location_enabled&#39;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.get_device_name" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_device_name</span><span class="p">(</span><span class="n">target</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns the name of a targeted device.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device or interaction URN.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the name of the device.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">get_device_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the name of a targeted device.</span>

<span class="sd">    Args:</span>
<span class="sd">        target (str): the device or interaction URN.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: the name of the device.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">v</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_device_info</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.get_device_type" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_device_type</span><span class="p">(</span><span class="n">target</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns the device type of a targeted device, i.e. gen 2, gen 3, etc.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device or interaction URN.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device type.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">get_device_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the device type of a targeted device, i.e. gen 2, gen 3, etc.</span>

<span class="sd">    Args:</span>
<span class="sd">        target (str): the device or interaction URN.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: the device type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">v</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_device_info</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.get_group_members" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_group_members</span><span class="p">(</span><span class="n">group_uri</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns the members of a particular group.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>group_uri</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the URN of the group that you would like to retrieve members from.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>str[]: a list of the members within the specified group.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">get_group_members</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the members of a particular group.</span>

<span class="sd">    Args:</span>
<span class="sd">        group_uri (str): the URN of the group that you would like to retrieve members from.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str[]: a list of the members within the specified group.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_group_query_request&#39;</span><span class="p">,</span>
        <span class="s1">&#39;query&#39;</span><span class="p">:</span> <span class="s1">&#39;list_members&#39;</span><span class="p">,</span>
        <span class="s1">&#39;group_uri&#39;</span><span class="p">:</span> <span class="n">group_uri</span>
    <span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;member_uris&#39;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.get_number_var" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_number_var</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Retrieves a variable that was set either during workflow registration
or through the set_var() function of type integer.  The variable can be retrieved anywhere
within the workflow, but is erased after the workflow terminates.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>name of the variable to be retrieved.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>default</code></td>
          <td>
                <code>optional</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>default value of the variable if it does not exist. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the variable requested.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">get_number_var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieves a variable that was set either during workflow registration</span>
<span class="sd">    or through the set_var() function of type integer.  The variable can be retrieved anywhere</span>
<span class="sd">    within the workflow, but is erased after the workflow terminates.</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): name of the variable to be retrieved.</span>
<span class="sd">        default (optional): default value of the variable if it does not exist. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        the variable requested.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_var</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.get_source_uri_from_trigger" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_source_uri_from_trigger</span><span class="p">(</span><span class="n">trigger</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get the source URN from a workflow trigger</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>trigger</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>workflow trigger.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="relay.workflow.WorkflowException">WorkflowException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>thrown if the trigger param is not a dictionary.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span title="relay.workflow.WorkflowException">WorkflowException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>thrown if the trigger param is not a trigger dictionary.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span title="relay.workflow.WorkflowException">WorkflowException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>thrown if there is no source_uri definition in the trigger.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the source URN as a string from the trigger.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">get_source_uri_from_trigger</span><span class="p">(</span><span class="n">trigger</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the source URN from a workflow trigger</span>

<span class="sd">    Args:</span>
<span class="sd">        trigger (dict): workflow trigger.</span>

<span class="sd">    Raises:</span>
<span class="sd">        WorkflowException: thrown if the trigger param is not a dictionary.</span>
<span class="sd">        WorkflowException: thrown if the trigger param is not a trigger dictionary.</span>
<span class="sd">        WorkflowException: thrown if there is no source_uri definition in the trigger.</span>

<span class="sd">    Returns:</span>
<span class="sd">        the source URN as a string from the trigger.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Relay</span><span class="o">.</span><span class="n">_validate_trigger</span><span class="p">(</span><span class="n">trigger</span><span class="p">)</span>
    <span class="n">source_uri</span> <span class="o">=</span> <span class="n">trigger</span><span class="p">[</span><span class="s1">&#39;args&#39;</span><span class="p">][</span><span class="s1">&#39;source_uri&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">source_uri</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.get_unread_inbox_size" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_unread_inbox_size</span><span class="p">(</span><span class="n">target</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Retrieves the number of messages in a device's inbox.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device or interaction URN whose inbox you would like to check.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the number of messages in the specified device's inbox.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">get_unread_inbox_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieves the number of messages in a device&#39;s inbox.</span>

<span class="sd">    Args:</span>
<span class="sd">        target (str): the device or interaction URN whose inbox you would like to check.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: the number of messages in the specified device&#39;s inbox.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_inbox_count_request&#39;</span><span class="p">,</span>
        <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.get_user_profile" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_user_profile</span><span class="p">(</span><span class="n">target</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns the user profile of a targeted device.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device or interaction URN.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the user profile registered to the device.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">get_user_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the user profile of a targeted device.</span>

<span class="sd">    Args:</span>
<span class="sd">        target (str): the device or interaction URN.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: the user profile registered to the device.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">v</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_device_info</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;username&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.get_var" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_var</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Retrieves a variable that was set either during workflow registration
or through the set_var() function.  The variable can be retrieved anywhere
within the workflow, but is erased after the workflow terminates.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>name of the variable to be retrieved.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>default</code></td>
          <td>
                <code>optional</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>default value of the variable if it does not exist. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the variable requested.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">get_var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieves a variable that was set either during workflow registration</span>
<span class="sd">    or through the set_var() function.  The variable can be retrieved anywhere</span>
<span class="sd">    within the workflow, but is erased after the workflow terminates.</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): name of the variable to be retrieved.</span>
<span class="sd">        default (optional): default value of the variable if it does not exist. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        the variable requested.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO: look in self.workflow.state to see all of what is available</span>
    <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_get_var_request&#39;</span><span class="p">,</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span>
    <span class="p">}</span>
    <span class="n">v</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">v</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.hangup_call" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">hangup_call</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">call_id</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Ends (hangs up) a call on a device.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device which will do the hangup.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>call_id</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the call ID.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">hangup_call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">call_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Ends (hangs up) a call on a device.</span>

<span class="sd">    Args:</span>
<span class="sd">        target (str): the device which will do the hangup.</span>
<span class="sd">        call_id (str): the call ID.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_hangup_request&#39;</span><span class="p">,</span>
        <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
        <span class="s1">&#39;call_id&#39;</span><span class="p">:</span> <span class="n">call_id</span>
    <span class="p">}</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.interaction_options" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">interaction_options</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;0000ff&#39;</span><span class="p">,</span> <span class="n">input_types</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">home_channel</span><span class="o">=</span><span class="s1">&#39;suspend&#39;</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Options for when an interaction is started via a workflow.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>color</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>desired color of LEDs when an interaction is started. Defaults to "0000ff".</p>
            </div>
          </td>
          <td>
                <code>&#39;0000ff&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>input_types</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>input types you would like for the interaction. Defaults to an empty list.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>home_channel</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>home channel for the device during the interaction. Defaults to "suspend".</p>
            </div>
          </td>
          <td>
                <code>&#39;suspend&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the options specified.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">interaction_options</span><span class="p">(</span><span class="n">color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;0000ff&quot;</span><span class="p">,</span> <span class="n">input_types</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">home_channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;suspend&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Options for when an interaction is started via a workflow.</span>

<span class="sd">    Args:</span>
<span class="sd">        color (str, optional): desired color of LEDs when an interaction is started. Defaults to &quot;0000ff&quot;.</span>
<span class="sd">        input_types (list, optional): input types you would like for the interaction. Defaults to an empty list.</span>
<span class="sd">        home_channel (str, optional): home channel for the device during the interaction. Defaults to &quot;suspend&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        the options specified.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">input_types</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">input_types</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">,</span>
        <span class="s1">&#39;input_types&#39;</span><span class="p">:</span> <span class="n">input_types</span><span class="p">,</span>
        <span class="s1">&#39;home_channel&#39;</span><span class="p">:</span> <span class="n">home_channel</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">options</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.is_group_member" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">is_group_member</span><span class="p">(</span><span class="n">group_name_uri</span><span class="p">,</span> <span class="n">potential_member_name_uri</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Checks whether a device is a member of a particular group.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>group_name_uri</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the URN of a group.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>potential_member_name_uri</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the URN of the device name.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>'true' if the device is a member of the specified group, 'false' otherwise.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">is_group_member</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group_name_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">potential_member_name_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks whether a device is a member of a particular group.</span>

<span class="sd">    Args:</span>
<span class="sd">        group_name_uri (str): the URN of a group.</span>
<span class="sd">        potential_member_name_uri: the URN of the device name.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: &#39;true&#39; if the device is a member of the specified group, &#39;false&#39; otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">this_group_name</span> <span class="o">=</span> <span class="n">parse_group_name</span><span class="p">(</span><span class="n">group_name_uri</span><span class="p">)</span>
    <span class="n">this_device_name</span> <span class="o">=</span> <span class="n">parse_device_name</span><span class="p">(</span><span class="n">potential_member_name_uri</span><span class="p">)</span>
    <span class="n">this_group_uri</span> <span class="o">=</span> <span class="n">group_member</span><span class="p">(</span><span class="n">this_group_name</span><span class="p">,</span> <span class="n">this_device_name</span><span class="p">)</span>
    <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_group_query_request&#39;</span><span class="p">,</span>
        <span class="s1">&#39;query&#39;</span><span class="p">:</span> <span class="s1">&#39;is_member&#39;</span><span class="p">,</span>
        <span class="s1">&#39;group_uri&#39;</span><span class="p">:</span> <span class="n">this_group_uri</span>
    <span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;is_member&#39;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.led_action" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">led_action</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">effect</span><span class="o">=</span><span class="s1">&#39;flash&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Private method used for performing actions on the LEDs, such as creating 
a rainbow, flashing, rotating, etc.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the interaction URN.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>effect</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>effect to perform on LEDs, can be 'rainbow', 'rotate', 'flash', 'breath',
'static', or 'off'. Defaults to 'flash'.</p>
            </div>
          </td>
          <td>
                <code>&#39;flash&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>args</code></td>
          <td>
                <code>optional</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>use led_info() to create args. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">led_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">effect</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;flash&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Private method used for performing actions on the LEDs, such as creating </span>
<span class="sd">    a rainbow, flashing, rotating, etc.</span>

<span class="sd">    Args:</span>
<span class="sd">        target (str): the interaction URN.</span>
<span class="sd">        effect (str, optional): effect to perform on LEDs, can be &#39;rainbow&#39;, &#39;rotate&#39;, &#39;flash&#39;, &#39;breath&#39;,</span>
<span class="sd">            &#39;static&#39;, or &#39;off&#39;. Defaults to &#39;flash&#39;.</span>
<span class="sd">        args (optional): use led_info() to create args. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_set_led_request&#39;</span><span class="p">,</span>
        <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
        <span class="s1">&#39;effect&#39;</span><span class="p">:</span> <span class="n">effect</span><span class="p">,</span>
        <span class="s1">&#39;args&#39;</span><span class="p">:</span> <span class="n">args</span>
    <span class="p">}</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.led_info" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">led_info</span><span class="p">(</span><span class="n">rotations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">repeat_delay</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pattern_repeats</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Sets information on a device, such as the number of rotations, count, duration, repeat delay,
pattern repeats, and colors.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>rotations</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>number of rotations. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>count</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the number of times the LEDs will perform an action. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>duration</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>duration of the LED action in milliseconds. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>repeat_delay</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the length of delay in milliseconds. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>pattern_repeats</code></td>
          <td>
                <code>_type_</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the number of times a pattern should repeat. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>colors</code></td>
          <td>
                <code>_type_</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>hex-code of the color for the LEDs. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>information field that was set on the LEDs.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">led_info</span><span class="p">(</span><span class="n">rotations</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">duration</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">repeat_delay</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">pattern_repeats</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets information on a device, such as the number of rotations, count, duration, repeat delay,</span>
<span class="sd">    pattern repeats, and colors.</span>

<span class="sd">    Args:</span>
<span class="sd">        rotations (int, optional): number of rotations. Defaults to None.</span>
<span class="sd">        count (int, optional): the number of times the LEDs will perform an action. Defaults to None.</span>
<span class="sd">        duration (int, optional): duration of the LED action in milliseconds. Defaults to None.</span>
<span class="sd">        repeat_delay (int, optional): the length of delay in milliseconds. Defaults to None.</span>
<span class="sd">        pattern_repeats (_type_, optional): the number of times a pattern should repeat. Defaults to None.</span>
<span class="sd">        colors (_type_, optional): hex-code of the color for the LEDs. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        information field that was set on the LEDs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">rotations</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;rotations&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rotations</span>
    <span class="k">if</span> <span class="n">count</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">count</span>
    <span class="k">if</span> <span class="n">duration</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">duration</span>
    <span class="k">if</span> <span class="n">repeat_delay</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;repeat_delay&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">repeat_delay</span>
    <span class="k">if</span> <span class="n">pattern_repeats</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;pattern_repeats&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pattern_repeats</span>
    <span class="k">if</span> <span class="n">colors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;colors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">colors</span>
    <span class="k">return</span> <span class="n">info</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.listen" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">listen</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">phrases</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transcribe</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alt_lang</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Listens for the user to speak into the device.  Utilizes speech to text functionality to interact
with the user.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the interaction URN.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>phrases</code></td>
          <td>
                <code>string[]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>optional phrases that you would like to limit the user's response to.
Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>transcribe</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>whether you would like to transcribe the user's reponse. Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>timeout</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>timeout for how long the device will wait for user's response. Defaults to 60.</p>
            </div>
          </td>
          <td>
                <code>60</code>
          </td>
        </tr>
        <tr>
          <td><code>alt_lang</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if you would like the device to listen for a response in a specific language.
Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>text representation of what the user had spoken into the device.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">listen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">phrases</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transcribe</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">alt_lang</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">60</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Listens for the user to speak into the device.  Utilizes speech to text functionality to interact</span>
<span class="sd">    with the user.</span>

<span class="sd">    Args:</span>
<span class="sd">        target (str): the interaction URN.</span>
<span class="sd">        phrases (string[], optional): optional phrases that you would like to limit the user&#39;s response to.</span>
<span class="sd">         Defaults to None.</span>
<span class="sd">        transcribe (bool, optional): whether you would like to transcribe the user&#39;s reponse. Defaults to True.</span>
<span class="sd">        timeout (int, optional): timeout for how long the device will wait for user&#39;s response. Defaults to 60.</span>
<span class="sd">        alt_lang (str, optional): if you would like the device to listen for a response in a specific language.</span>
<span class="sd">         Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        text representation of what the user had spoken into the device.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">phrases</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">phrases</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">phrases</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">phrases</span> <span class="o">=</span> <span class="p">[</span><span class="n">phrases</span><span class="p">]</span>

    <span class="n">_id</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span>
    <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_listen_request&#39;</span><span class="p">,</span>
        <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
        <span class="s1">&#39;phrases&#39;</span><span class="p">:</span> <span class="n">phrases</span><span class="p">,</span>
        <span class="s1">&#39;transcribe&#39;</span><span class="p">:</span> <span class="n">transcribe</span><span class="p">,</span>
        <span class="s1">&#39;timeout&#39;</span><span class="p">:</span> <span class="n">timeout</span><span class="p">,</span>
        <span class="s1">&#39;alt_lang&#39;</span><span class="p">:</span> <span class="n">alt_lang</span>
    <span class="p">}</span>

    <span class="n">criteria</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_speech_event&#39;</span><span class="p">,</span>
        <span class="s1">&#39;request_id&#39;</span><span class="p">:</span> <span class="n">_id</span>
    <span class="p">}</span>
    <span class="c1"># need to add this before _send_receive to avoid race condition</span>
    <span class="n">event_future</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_event_match</span><span class="p">(</span><span class="n">criteria</span><span class="p">)</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">_id</span><span class="p">)</span>
    <span class="n">speech_event</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_event_match</span><span class="p">(</span><span class="n">event_future</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">transcribe</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">speech_event</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">speech_event</span><span class="p">[</span><span class="s1">&#39;audio&#39;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.log_message" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">log_message</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="s1">&#39;text/plain&#39;</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Log an analytics event from a workflow with the specified content and
under a specified category. This does not log the device who
triggered the workflow that called this function.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>message</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>a description for your analytical event.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>category</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>a category for your analytical event. Defaults to 'default'.</p>
            </div>
          </td>
          <td>
                <code>&#39;default&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>URN of the device that triggered this function. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>content_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>encoding of the message string. Defaults to 'text/plain'.</p>
            </div>
          </td>
          <td>
                <code>&#39;text/plain&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">log_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">category</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">content_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;text/plain&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Log an analytics event from a workflow with the specified content and</span>
<span class="sd">    under a specified category. This does not log the device who</span>
<span class="sd">    triggered the workflow that called this function.</span>

<span class="sd">    Args:</span>
<span class="sd">        message (str): a description for your analytical event.</span>
<span class="sd">        category (str, optional): a category for your analytical event. Defaults to &#39;default&#39;.</span>
<span class="sd">        target (str, optional): URN of the device that triggered this function. Defaults to None.</span>
<span class="sd">        content_type (str, optional): encoding of the message string. Defaults to &#39;text/plain&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_log_analytics_event_request&#39;</span><span class="p">,</span>
        <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="n">message</span><span class="p">,</span>
        <span class="s1">&#39;content_type&#39;</span><span class="p">:</span> <span class="n">content_type</span><span class="p">,</span>
        <span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="n">category</span><span class="p">,</span>
        <span class="s1">&#39;device_uri&#39;</span><span class="p">:</span> <span class="n">target</span>
    <span class="p">}</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.log_user_message" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">log_user_message</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">category</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Log an analytic event from a workflow with the specified content and
under a specified category.  This includes the device who triggered the workflow
that called this function.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>message</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>a description for your analytical event.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the URN of a the device that triggered this function. Defaults to None.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>category</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>a category for your analytical event.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">log_user_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">category</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Log an analytic event from a workflow with the specified content and</span>
<span class="sd">    under a specified category.  This includes the device who triggered the workflow</span>
<span class="sd">    that called this function.</span>

<span class="sd">    Args:</span>
<span class="sd">        message (str): a description for your analytical event.</span>
<span class="sd">        target (str, optional): the URN of a the device that triggered this function. Defaults to None.</span>
<span class="sd">        category (str): a category for your analytical event.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_log_analytics_event_request&#39;</span><span class="p">,</span>
        <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="n">message</span><span class="p">,</span>
        <span class="s1">&#39;content_type&#39;</span><span class="p">:</span> <span class="s1">&#39;text/plain&#39;</span><span class="p">,</span>
        <span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="n">category</span><span class="p">,</span>
        <span class="s1">&#39;device_uri&#39;</span><span class="p">:</span> <span class="n">target</span>
    <span class="p">}</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.make_target_uris" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">make_target_uris</span><span class="p">(</span><span class="n">trigger</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Creates a target URN after receiving a workflow trigger.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>trigger</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>workflow trigger.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="relay.workflow.WorkflowException">WorkflowException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>thrown if the trigger param is not a dictionary.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span title="relay.workflow.WorkflowException">WorkflowException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>thrown if the trigger param is not a trigger dictionary.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span title="relay.workflow.WorkflowException">WorkflowException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>thrown if there is no source_uri definition in the trigger.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>a target object created from the trigger.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">make_target_uris</span><span class="p">(</span><span class="n">trigger</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a target URN after receiving a workflow trigger.</span>

<span class="sd">    Args:</span>
<span class="sd">        trigger (dict): workflow trigger.</span>

<span class="sd">    Raises:</span>
<span class="sd">        WorkflowException: thrown if the trigger param is not a dictionary.</span>
<span class="sd">        WorkflowException: thrown if the trigger param is not a trigger dictionary.</span>
<span class="sd">        WorkflowException: thrown if there is no source_uri definition in the trigger.</span>

<span class="sd">    Returns:</span>
<span class="sd">        a target object created from the trigger.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Relay</span><span class="o">.</span><span class="n">_validate_trigger</span><span class="p">(</span><span class="n">trigger</span><span class="p">)</span>
    <span class="n">target</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;uris&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">trigger</span><span class="p">[</span><span class="s1">&#39;args&#39;</span><span class="p">][</span><span class="s1">&#39;source_uri&#39;</span><span class="p">]]</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">target</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.place_call" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">place_call</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">callee_uri</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Places a call to another device.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device which will place the call.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>callee_uri</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the URN of the device you would like to call.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the event response.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">place_call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">callee_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Places a call to another device.</span>

<span class="sd">    Args:</span>
<span class="sd">        target (str): the device which will place the call.</span>
<span class="sd">        callee_uri (str): the URN of the device you would like to call.</span>

<span class="sd">    Returns:</span>
<span class="sd">        the event response.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_call_request&#39;</span><span class="p">,</span>
        <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
        <span class="s1">&#39;uri&#39;</span><span class="p">:</span> <span class="n">callee_uri</span>
    <span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;call_id&#39;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.play" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">play</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Plays a custom audio file that was uploaded by the user.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target(str)</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the interaction URN.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>filename</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the name of the audio file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the response id after the audio file has been played on the device.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">play</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plays a custom audio file that was uploaded by the user.</span>

<span class="sd">    Args:</span>
<span class="sd">        target(str): the interaction URN.</span>
<span class="sd">        filename (str): the name of the audio file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        the response id after the audio file has been played on the device.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_play_request&#39;</span><span class="p">,</span>
        <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
        <span class="s1">&#39;filename&#39;</span><span class="p">:</span> <span class="n">filename</span>
    <span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.play_and_wait" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">play_and_wait</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Plays a custom audio file that was uploaded by the user.
Waits until the audio file has finished playing before continuing through
the workflow.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target(str)</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the interaction URN.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>filename</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the name of the audio file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the response id after the audio file has been played on the device.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">play_and_wait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plays a custom audio file that was uploaded by the user.</span>
<span class="sd">    Waits until the audio file has finished playing before continuing through</span>
<span class="sd">    the workflow.</span>

<span class="sd">    Args:</span>
<span class="sd">        target(str): the interaction URN.</span>
<span class="sd">        filename (str): the name of the audio file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        the response id after the audio file has been played on the device.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_id</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span>
    <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_play_request&#39;</span><span class="p">,</span>
        <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
        <span class="s1">&#39;filename&#39;</span><span class="p">:</span> <span class="n">filename</span>
    <span class="p">}</span>

    <span class="n">criteria</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_prompt_event&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;stopped&#39;</span><span class="p">,</span>
        <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">_id</span>
    <span class="p">}</span>

    <span class="n">event_future</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_event_match</span><span class="p">(</span><span class="n">criteria</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">_id</span><span class="p">)</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_event_match</span><span class="p">(</span><span class="n">event_future</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.play_unread_inbox_messages" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">play_unread_inbox_messages</span><span class="p">(</span><span class="n">target</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Play a targeted device's inbox messages.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device or interaction URN whose inbox messages you would like to play.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">play_unread_inbox_messages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Play a targeted device&#39;s inbox messages.</span>

<span class="sd">    Args:</span>
<span class="sd">        target (str): the device or interaction URN whose inbox messages you would like to play.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_play_inbox_messages_request&#39;</span><span class="p">,</span>
        <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.push_options" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">push_options</span><span class="p">(</span><span class="n">priority</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sound</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Push options for a virtual device after receiving a notification on the Relay App.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>priority</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>priority of the notification. Can be 'normal', 'high', or 'critical'.
Defaults to 'normal'.</p>
            </div>
          </td>
          <td>
                <code>&#39;normal&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>title</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>title of the notification. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>body</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>body of the notification. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>sound</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>sound to be played when notification appears on app. Can be 'default', or 'sos'.
Defaults to 'default'.</p>
            </div>
          </td>
          <td>
                <code>&#39;default&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the options for priority and sound as specified.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">push_options</span><span class="p">(</span><span class="n">priority</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">body</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">sound</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Push options for a virtual device after receiving a notification on the Relay App.</span>

<span class="sd">    Args:</span>
<span class="sd">        priority (str, optional): priority of the notification. Can be &#39;normal&#39;, &#39;high&#39;, or &#39;critical&#39;.</span>
<span class="sd">         Defaults to &#39;normal&#39;.</span>
<span class="sd">        title (str, optional): title of the notification. Defaults to None.</span>
<span class="sd">        body (str, optional): body of the notification. Defaults to None.</span>
<span class="sd">        sound (str, optional): sound to be played when notification appears on app. Can be &#39;default&#39;, or &#39;sos&#39;.</span>
<span class="sd">          Defaults to &#39;default&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        the options for priority and sound as specified.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;priority&#39;</span><span class="p">:</span> <span class="n">priority</span><span class="p">,</span>
        <span class="s1">&#39;sound&#39;</span><span class="p">:</span> <span class="n">sound</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">options</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">title</span>
    <span class="k">if</span> <span class="n">body</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">options</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">body</span>
    <span class="k">return</span> <span class="n">options</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.rainbow" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">rainbow</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">rotations</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Switches all the LEDs on to a configured rainbow pattern and rotates the rainbow
a specified number of times.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the interaction URN.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rotations</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the number of times you would like the rainbow to rotate. Defaults to -1,
meaning the rainbow will rotate indefinitely.</p>
            </div>
          </td>
          <td>
                <code>-1</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">rainbow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">rotations</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Switches all the LEDs on to a configured rainbow pattern and rotates the rainbow</span>
<span class="sd">    a specified number of times.</span>

<span class="sd">    Args:</span>
<span class="sd">        target (str): the interaction URN.</span>
<span class="sd">        rotations (int, optional): the number of times you would like the rainbow to rotate. Defaults to -1,</span>
<span class="sd">         meaning the rainbow will rotate indefinitely.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">led_action</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;rainbow&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;rotations&#39;</span><span class="p">:</span> <span class="n">rotations</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.resolve_incident" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">resolve_incident</span><span class="p">(</span><span class="n">incident_id</span><span class="p">,</span> <span class="n">reason</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Resolves an incident that was created.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>incident_id</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the ID of the incident you would like to resolve.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>reason</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the reason for resolving the incident.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">resolve_incident</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">incident_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">reason</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Resolves an incident that was created.</span>

<span class="sd">    Args:</span>
<span class="sd">        incident_id (str): the ID of the incident you would like to resolve.</span>
<span class="sd">        reason (str): the reason for resolving the incident.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_resolve_incident_request&#39;</span><span class="p">,</span>
        <span class="s1">&#39;incident_id&#39;</span><span class="p">:</span> <span class="n">incident_id</span><span class="p">,</span>
        <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="n">reason</span>
    <span class="p">}</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.rotate" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">rotate</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0000ff&#39;</span><span class="p">,</span> <span class="n">rotations</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Switches all the LEDs on a device to a certain color and rotates them a specified number
of times.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the interaction URN.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>color</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the hex color code you would like to turn the LEDs to. Defaults to '0000ff'.</p>
            </div>
          </td>
          <td>
                <code>&#39;0000ff&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>rotations</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the number of times you would like the LEDs to rotate. Defaults to -1, meaning</p>
            </div>
          </td>
          <td>
                <code>-1</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;0000ff&#39;</span><span class="p">,</span> <span class="n">rotations</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Switches all the LEDs on a device to a certain color and rotates them a specified number</span>
<span class="sd">    of times.</span>

<span class="sd">    Args:</span>
<span class="sd">        target (str): the interaction URN.</span>
<span class="sd">        color (str, optional): the hex color code you would like to turn the LEDs to. Defaults to &#39;0000ff&#39;.</span>
<span class="sd">        rotations (int, optional): the number of times you would like the LEDs to rotate. Defaults to -1, meaning</span>
<span class="sd">        the LEDs will rotate indefinitely.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">led_action</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;rotate&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;1&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">},</span> <span class="s1">&#39;rotations&#39;</span><span class="p">:</span> <span class="n">rotations</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.say" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">say</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s1">&#39;en-US&#39;</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Utilizes text to speech capabilities to make the device 'speak' to the user.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target(str)</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the interaction URN.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>text</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>what you would like the device to say.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>lang</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the language of the text that is being spoken. Defaults to 'en-US'.</p>
            </div>
          </td>
          <td>
                <code>&#39;en-US&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the response ID after the device speaks to the user.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">say</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">lang</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;en-US&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Utilizes text to speech capabilities to make the device &#39;speak&#39; to the user.</span>

<span class="sd">    Args:</span>
<span class="sd">        target(str): the interaction URN.</span>
<span class="sd">        text (str): what you would like the device to say.</span>
<span class="sd">        lang (str, optional): the language of the text that is being spoken. Defaults to &#39;en-US&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        the response ID after the device speaks to the user.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_say_request&#39;</span><span class="p">,</span>
        <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
        <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="n">text</span><span class="p">,</span>
        <span class="s1">&#39;lang&#39;</span><span class="p">:</span> <span class="n">lang</span>
    <span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.say_and_wait" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">say_and_wait</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s1">&#39;en-US&#39;</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Utilizes text to speech capabilities to make the device 'speak' to the user.
Waits until the text is fully played out on the device before continuing.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target(str)</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the interaction URN.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>text</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>what you would like the device to say.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>lang</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the language of the text that is being spoken. Defaults to 'en-US'.</p>
            </div>
          </td>
          <td>
                <code>&#39;en-US&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the response ID after the device speaks to the user.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">say_and_wait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">lang</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;en-US&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Utilizes text to speech capabilities to make the device &#39;speak&#39; to the user.</span>
<span class="sd">    Waits until the text is fully played out on the device before continuing.</span>

<span class="sd">    Args:</span>
<span class="sd">        target(str): the interaction URN.</span>
<span class="sd">        text (str): what you would like the device to say.</span>
<span class="sd">        lang (str, optional): the language of the text that is being spoken. Defaults to &#39;en-US&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        the response ID after the device speaks to the user.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_id</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span>
    <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_say_request&#39;</span><span class="p">,</span>
        <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
        <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="n">text</span><span class="p">,</span>
        <span class="s1">&#39;lang&#39;</span><span class="p">:</span> <span class="n">lang</span>
    <span class="p">}</span>

    <span class="n">criteria</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_prompt_event&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;stopped&#39;</span><span class="p">,</span>
        <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">_id</span><span class="p">}</span>

    <span class="n">event_future</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_event_match</span><span class="p">(</span><span class="n">criteria</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">_id</span><span class="p">)</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_event_match</span><span class="p">(</span><span class="n">event_future</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;wait complete for </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.set_channel" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">set_channel</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">channel_name</span><span class="p">,</span> <span class="n">suppress_tts</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">disable_home_channel</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Sets the channel that a device is on.  This can be used to change the channel of a device during a workflow,
where the channel will also be updated on the Relay Dash.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device or interaction URN.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>channel_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the name of the channel you would like to set your device to.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>suppress_tts</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>whether you would like to surpress text to speech. Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>disable_home_channel</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>whether you would like to disable the home channel.
Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">set_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">channel_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">suppress_tts</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                      <span class="n">disable_home_channel</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets the channel that a device is on.  This can be used to change the channel of a device during a workflow,</span>
<span class="sd">    where the channel will also be updated on the Relay Dash.</span>

<span class="sd">    Args:</span>
<span class="sd">        target (str): the device or interaction URN.</span>
<span class="sd">        channel_name (str): the name of the channel you would like to set your device to.</span>
<span class="sd">        suppress_tts (bool, optional): whether you would like to surpress text to speech. Defaults to False.</span>
<span class="sd">        disable_home_channel (bool, optional): whether you would like to disable the home channel.</span>
<span class="sd">         Defaults to False.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_set_channel_request&#39;</span><span class="p">,</span>
        <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
        <span class="s1">&#39;channel_name&#39;</span><span class="p">:</span> <span class="n">channel_name</span><span class="p">,</span>
        <span class="s1">&#39;suppress_tts&#39;</span><span class="p">:</span> <span class="n">suppress_tts</span><span class="p">,</span>
        <span class="s1">&#39;disable_home_channel&#39;</span><span class="p">:</span> <span class="n">disable_home_channel</span>
    <span class="p">}</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.set_device_name" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">set_device_name</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Sets the name of a targeted device and updates it on the Relay Dash.
The name remains updated until it is set again via a workflow or updated manually
on the Relay Dash.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device or interaction URN.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>a new name for your device.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">set_device_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets the name of a targeted device and updates it on the Relay Dash.</span>
<span class="sd">    The name remains updated until it is set again via a workflow or updated manually</span>
<span class="sd">    on the Relay Dash.</span>

<span class="sd">    Args:</span>
<span class="sd">        target (str): the device or interaction URN.</span>
<span class="sd">        name (str): a new name for your device.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_device_info</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.set_timer" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">set_timer</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">timer_type</span><span class="o">=</span><span class="s1">&#39;timeout&#39;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">timeout_type</span><span class="o">=</span><span class="s1">&#39;secs&#39;</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Serves as a named timer that can be either interval or timeout.  Allows you to specify
the unit of time.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>a name for your timer.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>timer_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>can be 'timeout' or 'interval'. Defaults to 'timeout'.</p>
            </div>
          </td>
          <td>
                <code>&#39;timeout&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>timeout</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>an integer representing when you would like your timer to fire.</p>
            </div>
          </td>
          <td>
                <code>60</code>
          </td>
        </tr>
        <tr>
          <td><code>timeout_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>can be 'ms', 'secs', 'mins' or 'hrs'. Defaults to 'secs'.</p>
            </div>
          </td>
          <td>
                <code>&#39;secs&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span>
<span class="normal">2082</span>
<span class="normal">2083</span>
<span class="normal">2084</span>
<span class="normal">2085</span>
<span class="normal">2086</span>
<span class="normal">2087</span>
<span class="normal">2088</span>
<span class="normal">2089</span>
<span class="normal">2090</span>
<span class="normal">2091</span>
<span class="normal">2092</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">set_timer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">timer_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;timeout&#39;</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span> <span class="n">timeout_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;secs&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Serves as a named timer that can be either interval or timeout.  Allows you to specify</span>
<span class="sd">    the unit of time.</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): a name for your timer.</span>
<span class="sd">        timer_type (str, optional): can be &#39;timeout&#39; or &#39;interval&#39;. Defaults to &#39;timeout&#39;.</span>
<span class="sd">        timeout (int): an integer representing when you would like your timer to fire.</span>
<span class="sd">        timeout_type (str, optional): can be &#39;ms&#39;, &#39;secs&#39;, &#39;mins&#39; or &#39;hrs&#39;. Defaults to &#39;secs&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_set_timer_request&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">timer_type</span><span class="p">,</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
        <span class="s1">&#39;timeout&#39;</span><span class="p">:</span> <span class="n">timeout</span><span class="p">,</span>
        <span class="s1">&#39;timeout_type&#39;</span><span class="p">:</span> <span class="n">timeout_type</span>
    <span class="p">}</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.set_user_profile" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">set_user_profile</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Sets the profile of a user by updating the username.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device URN whose profile you would like to update.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>username</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the updated username for the device.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>force</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>whether you would like to force this update. Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">set_user_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets the profile of a user by updating the username.</span>

<span class="sd">    Args:</span>
<span class="sd">        target (str): the device URN whose profile you would like to update.</span>
<span class="sd">        username (str): the updated username for the device.</span>
<span class="sd">        force (bool, optional): whether you would like to force this update. Defaults to False.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_set_user_profile_request&#39;</span><span class="p">,</span>
        <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
        <span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="n">username</span><span class="p">,</span>
        <span class="s1">&#39;force&#39;</span><span class="p">:</span> <span class="n">force</span>
    <span class="p">}</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.set_var" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">set_var</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Sets a variable with the corresponding name and value. Scope of
the variable is from start to end of a workflow.  Note that you 
can only set values of type string.
Args:
    name (str): name of the variable to be created.
    value (str): value that the variable will hold.</p>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span>
<span class="normal">985</span>
<span class="normal">986</span>
<span class="normal">987</span>
<span class="normal">988</span>
<span class="normal">989</span>
<span class="normal">990</span>
<span class="normal">991</span>
<span class="normal">992</span>
<span class="normal">993</span>
<span class="normal">994</span>
<span class="normal">995</span>
<span class="normal">996</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">set_var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets a variable with the corresponding name and value. Scope of</span>
<span class="sd">    the variable is from start to end of a workflow.  Note that you </span>
<span class="sd">    can only set values of type string.</span>
<span class="sd">    Args:</span>
<span class="sd">        name (str): name of the variable to be created.</span>
<span class="sd">        value (str): value that the variable will hold.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_set_var_request&#39;</span><span class="p">,</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
        <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">value</span>
    <span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.start_interaction" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">start_interaction</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Starts an interaction with the user.  Triggers an INTERACTION_STARTED event
and allows the user to interact with the device via functions that require an 
interaction URN.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>target</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device that you would like to start an interaction with.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>a name for your interaction.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>options</code></td>
          <td>
                <code>optional</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>can be color, home channel, or input types. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">start_interaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Starts an interaction with the user.  Triggers an INTERACTION_STARTED event</span>
<span class="sd">    and allows the user to interact with the device via functions that require an </span>
<span class="sd">    interaction URN.</span>

<span class="sd">    Args:</span>
<span class="sd">        target (target): the device that you would like to start an interaction with.</span>
<span class="sd">        name (str): a name for your interaction.</span>
<span class="sd">        options (optional): can be color, home channel, or input types. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_start_interaction_request&#39;</span><span class="p">,</span>
        <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="n">target</span><span class="p">,</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
        <span class="s1">&#39;options&#39;</span><span class="p">:</span> <span class="n">options</span>
    <span class="p">}</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.start_timer" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">start_timer</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Starts an unnamed timer, meaning this will be the only timer on your device.
The timer will fire when it reaches the value of the 'timeout' parameter.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>timeout</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the number of seconds you would like to wait until the timer fires.</p>
            </div>
          </td>
          <td>
                <code>60</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">start_timer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">60</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Starts an unnamed timer, meaning this will be the only timer on your device.</span>
<span class="sd">    The timer will fire when it reaches the value of the &#39;timeout&#39; parameter.</span>

<span class="sd">    Args:</span>
<span class="sd">        timeout (int): the number of seconds you would like to wait until the timer fires.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_start_timer_request&#39;</span><span class="p">,</span>
        <span class="s1">&#39;timeout&#39;</span><span class="p">:</span> <span class="n">timeout</span>
    <span class="p">}</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.stop_timer" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">stop_timer</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Stops an unnamed timer.</p>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">stop_timer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Stops an unnamed timer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_stop_timer_request&#39;</span>
    <span class="p">}</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.switch_all_led_off" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">switch_all_led_off</span><span class="p">(</span><span class="n">target</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Switches all the LEDs on a device off.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the interaction URN.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">switch_all_led_off</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Switches all the LEDs on a device off.</span>

<span class="sd">    Args:</span>
<span class="sd">        target (str): the interaction URN.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">led_action</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;off&#39;</span><span class="p">,</span> <span class="p">{})</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.switch_all_led_on" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">switch_all_led_on</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0000ff&#39;</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Switches all the LEDs on a device on to a specified color.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the interaction URN.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>color</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the hex color code you would like the LEDs to be. Defaults to '0000ff'.</p>
            </div>
          </td>
          <td>
                <code>&#39;0000ff&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">switch_all_led_on</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;0000ff&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Switches all the LEDs on a device on to a specified color.</span>

<span class="sd">    Args:</span>
<span class="sd">        target (str): the interaction URN.</span>
<span class="sd">        color (str, optional): the hex color code you would like the LEDs to be. Defaults to &#39;0000ff&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">led_action</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;static&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;ring&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">}})</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.switch_led_on" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">switch_led_on</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0000ff&#39;</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Switches on an LED at a particular index to a specified color.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the interaction URN.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>index</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the index of an LED, numbered 1-12.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>color</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the hex color code you would like to turn the LED to. Defaults to '0000ff'.</p>
            </div>
          </td>
          <td>
                <code>&#39;0000ff&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">switch_led_on</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;0000ff&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Switches on an LED at a particular index to a specified color.</span>

<span class="sd">    Args:</span>
<span class="sd">        target (str): the interaction URN.</span>
<span class="sd">        index (int): the index of an LED, numbered 1-12.</span>
<span class="sd">        color (str, optional): the hex color code you would like to turn the LED to. Defaults to &#39;0000ff&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">led_action</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;static&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="p">{</span><span class="n">index</span><span class="p">:</span> <span class="n">color</span><span class="p">}})</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.targets_from_source_uri" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">source_uri</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Creates a target object from a source URN.
Enables the device to perform the desired action after the function
has been called.  Used interanlly by interaction functions such as
say(), listen(), vibration(), etc.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>source_uri</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>source uri that will be used to create a target.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the target that was created from a source URN.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">targets_from_source_uri</span><span class="p">(</span><span class="n">source_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a target object from a source URN.</span>
<span class="sd">    Enables the device to perform the desired action after the function</span>
<span class="sd">    has been called.  Used interanlly by interaction functions such as</span>
<span class="sd">    say(), listen(), vibration(), etc.</span>

<span class="sd">    Args:</span>
<span class="sd">        source_uri (str): source uri that will be used to create a target.</span>

<span class="sd">    Returns:</span>
<span class="sd">        the target that was created from a source URN.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">targets</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;uris&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">source_uri</span><span class="p">]</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">targets</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.terminate" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">terminate</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Terminates a workflow.  This method is usually called
after your workflow has completed, and you would like to end the
workflow by calling end_interaction(), where you can then terminate
the workflow.</p>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">terminate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Terminates a workflow.  This method is usually called</span>
<span class="sd">    after your workflow has completed, and you would like to end the</span>
<span class="sd">    workflow by calling end_interaction(), where you can then terminate</span>
<span class="sd">    the workflow.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_terminate_request&#39;</span>
    <span class="p">}</span>
    <span class="c1"># there is no response</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.translate" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">translate</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">from_lang</span><span class="o">=</span><span class="s1">&#39;en-US&#39;</span><span class="p">,</span> <span class="n">to_lang</span><span class="o">=</span><span class="s1">&#39;es-ES&#39;</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Translates text from one language to another.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>text</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the text that you would like to translate.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>from_lang</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the language that you would like to translate from.</p>
            </div>
          </td>
          <td>
                <code>&#39;en-US&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>to_lang</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the language that you would like to translate to.</p>
            </div>
          </td>
          <td>
                <code>&#39;es-ES&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the translated text.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">from_lang</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;en-US&#39;</span><span class="p">,</span> <span class="n">to_lang</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;es-ES&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Translates text from one language to another.</span>

<span class="sd">    Args:</span>
<span class="sd">        text (str): the text that you would like to translate.</span>
<span class="sd">        from_lang (str): the language that you would like to translate from.</span>
<span class="sd">        to_lang (str): the language that you would like to translate to.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: the translated text.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_translate_request&#39;</span><span class="p">,</span>
        <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="n">text</span><span class="p">,</span>
        <span class="s1">&#39;from_lang&#39;</span><span class="p">:</span> <span class="n">from_lang</span><span class="p">,</span>
        <span class="s1">&#39;to_lang&#39;</span><span class="p">:</span> <span class="n">to_lang</span>
    <span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.unset_var" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">unset_var</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Unsets the value of a variable.  </p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the name of the variable whose value you would like to unset.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">unset_var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Unsets the value of a variable.  </span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): the name of the variable whose value you would like to unset.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_unset_var_request&#39;</span><span class="p">,</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span>
    <span class="p">}</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Relay.vibrate" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">vibrate</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Makes the device vibrate in a particular pattern.  You can specify
how many vibrations you would like, the duration of each vibration in
milliseconds, and how long you would like the pauses between each vibration to last
in milliseconds.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the interaction URN.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>pattern</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>an array representing the pattern of your vibration. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">vibrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">pattern</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Makes the device vibrate in a particular pattern.  You can specify</span>
<span class="sd">    how many vibrations you would like, the duration of each vibration in</span>
<span class="sd">    milliseconds, and how long you would like the pauses between each vibration to last</span>
<span class="sd">    in milliseconds.</span>

<span class="sd">    Args:</span>
<span class="sd">        target (str): the interaction URN.</span>
<span class="sd">        pattern (list, optional): an array representing the pattern of your vibration. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pattern</span><span class="p">:</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">]</span>

    <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;_type&#39;</span><span class="p">:</span> <span class="s1">&#39;wf_api_vibrate_request&#39;</span><span class="p">,</span>
        <span class="s1">&#39;_target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets_from_source_uri</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
        <span class="s1">&#39;pattern&#39;</span><span class="p">:</span> <span class="n">pattern</span>
    <span class="p">}</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_receive</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="relay.workflow.Server" class="doc doc-heading">
          <code>Server</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>A websocket server that gets connected to when a new workflow
is instantiated via a trigger.</p>
<p>Events are sent here, and the connection is also used to send actions to the Relay server.</p>

            <details class="quote">
              <summary>Source code in <code>relay/workflow.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Server</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A websocket server that gets connected to when a new workflow</span>
<span class="sd">    is instantiated via a trigger.</span>

<span class="sd">    Events are sent here, and the connection is also used to send actions to the Relay server.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">port</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            host: the IP address of the interface that this server should</span>
<span class="sd">             listen on. Typically is &quot;0.0.0.0&quot;, which represents all interfaces.</span>
<span class="sd">            port: the port number that this server should listen on.</span>
<span class="sd">            **kwargs: see below</span>

<span class="sd">        Keyword Args:</span>
<span class="sd">            log_level: sets the threshold level for the logger in this module.</span>
<span class="sd">            log_handler: a log handler object to be added to the logger in this</span>
<span class="sd">             module. To disable logging output, use `logging.NullHandler()`.</span>
<span class="sd">            ssl_key_filename: if an SSLContext is desired for this server,</span>
<span class="sd">             this is the filename where the key in PEM format can be found.</span>
<span class="sd">             Should also use ssl_cert_filename if this is specified.</span>
<span class="sd">            ssl_cert_filename: if an SSLContext is desired for this server,</span>
<span class="sd">             this is the filename where the certificate in PEM format can</span>
<span class="sd">             be found. Should also use ssl_key_filename if this is specified.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span class="n">host</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">port</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">workflows</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># {path: workflow}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conn_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;ssl_key_filename&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ssl_key_filename</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;ssl_cert_filename&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ssl_cert_filename</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;log_level&#39;</span><span class="p">:</span>
                <span class="n">this_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
                <span class="n">this_logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;log_handler&#39;</span><span class="p">:</span>
                <span class="c1"># if logging.NullHandler() is added then nothing will appear on the console</span>
                <span class="n">this_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
                <span class="n">this_logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">register</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">workflow</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">workflows</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ServerException</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;a workflow is already registered at path </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">workflows</span><span class="p">[</span><span class="n">path</span><span class="p">]</span> <span class="o">=</span> <span class="n">workflow</span>

    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">custom_headers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Server&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">VERSION</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">}</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;ssl_key_filename&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;ssl_cert_filename&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">access</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ssl_cert_filename</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">R_OK</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">ServerException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;can&#39;t read ssl_cert_file </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ssl_cert_filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">access</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ssl_key_filename</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">R_OK</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">ServerException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;can&#39;t read ssl_key_file </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ssl_key_filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">ssl_context</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">SSLContext</span><span class="p">(</span><span class="n">ssl</span><span class="o">.</span><span class="n">PROTOCOL_TLS_SERVER</span><span class="p">)</span>
            <span class="n">ssl_context</span><span class="o">.</span><span class="n">load_cert_chain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ssl_cert_filename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ssl_key_filename</span><span class="p">)</span>
            <span class="n">start_server</span> <span class="o">=</span> <span class="n">websockets</span><span class="o">.</span><span class="n">serve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">,</span>
                                            <span class="n">extra_headers</span><span class="o">=</span><span class="n">custom_headers</span><span class="p">,</span> <span class="n">ssl</span><span class="o">=</span><span class="n">ssl_context</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;Relay workflow server (</span><span class="si">{</span><span class="n">VERSION</span><span class="si">}</span><span class="s1">) listening on </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="si">}</span><span class="s1"> port </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="si">}</span><span class="s1">&#39;</span>
                <span class="sa">f</span><span class="s1">&#39; with ssl_context </span><span class="si">{</span><span class="n">ssl_context</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">start_server</span> <span class="o">=</span> <span class="n">websockets</span><span class="o">.</span><span class="n">serve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">,</span> <span class="n">extra_headers</span><span class="o">=</span><span class="n">custom_headers</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Relay workflow server (</span><span class="si">{</span><span class="n">VERSION</span><span class="si">}</span><span class="s1">) listening on </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="si">}</span><span class="s1">&#39;</span>
                        <span class="sa">f</span><span class="s1">&#39; port </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="si">}</span><span class="s1"> with plaintext&#39;</span><span class="p">)</span>

        <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">start_server</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span><span class="o">.</span><span class="n">run_forever</span><span class="p">()</span>

        <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;server terminated&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">total_connections</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn_count</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">websocket</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>

        <span class="n">workflow</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workflows</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">workflow</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;handling request on path </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">relay</span> <span class="o">=</span> <span class="n">Relay</span><span class="p">(</span><span class="n">workflow</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">conn_count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">await</span> <span class="n">relay</span><span class="o">.</span><span class="n">_handle</span><span class="p">(</span><span class="n">websocket</span><span class="p">)</span>

            <span class="k">finally</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">conn_count</span> <span class="o">-=</span> <span class="mi">1</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ignoring request for unregistered path </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">await</span> <span class="n">websocket</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Server.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>host</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the IP address of the interface that this server should
listen on. Typically is "0.0.0.0", which represents all interfaces.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>port</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the port number that this server should listen on.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>see below</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Other Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>log_level</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>sets the threshold level for the logger in this module.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>log_handler</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>a log handler object to be added to the logger in this
module. To disable logging output, use <code>logging.NullHandler()</code>.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>ssl_key_filename</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if an SSLContext is desired for this server,
this is the filename where the key in PEM format can be found.
Should also use ssl_cert_filename if this is specified.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>ssl_cert_filename</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if an SSLContext is desired for this server,
this is the filename where the certificate in PEM format can
be found. Should also use ssl_key_filename if this is specified.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">port</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        host: the IP address of the interface that this server should</span>
<span class="sd">         listen on. Typically is &quot;0.0.0.0&quot;, which represents all interfaces.</span>
<span class="sd">        port: the port number that this server should listen on.</span>
<span class="sd">        **kwargs: see below</span>

<span class="sd">    Keyword Args:</span>
<span class="sd">        log_level: sets the threshold level for the logger in this module.</span>
<span class="sd">        log_handler: a log handler object to be added to the logger in this</span>
<span class="sd">         module. To disable logging output, use `logging.NullHandler()`.</span>
<span class="sd">        ssl_key_filename: if an SSLContext is desired for this server,</span>
<span class="sd">         this is the filename where the key in PEM format can be found.</span>
<span class="sd">         Should also use ssl_cert_filename if this is specified.</span>
<span class="sd">        ssl_cert_filename: if an SSLContext is desired for this server,</span>
<span class="sd">         this is the filename where the certificate in PEM format can</span>
<span class="sd">         be found. Should also use ssl_key_filename if this is specified.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span class="n">host</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">port</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">workflows</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># {path: workflow}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">conn_count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;ssl_key_filename&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ssl_key_filename</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;ssl_cert_filename&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ssl_cert_filename</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;log_level&#39;</span><span class="p">:</span>
            <span class="n">this_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
            <span class="n">this_logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;log_handler&#39;</span><span class="p">:</span>
            <span class="c1"># if logging.NullHandler() is added then nothing will appear on the console</span>
            <span class="n">this_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
            <span class="n">this_logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="relay.workflow.Workflow" class="doc doc-heading">
          <code>Workflow</code>


</h2>


  <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>relay/workflow.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Workflow</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># {(type, args): func}</span>

    <span class="k">def</span> <span class="nf">on_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A decorator for a handler method for the START event (workflow is starting).</span>

<span class="sd">        async def start_handler(workflow:relay.workflow.Workflow, trigger:dict)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_start_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">def</span> <span class="nf">on_stop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A decorator for a handler method for the STOP event (workflow is stopping).</span>

<span class="sd">        async def stop_handler(workflow:relay.workflow.Workflow, reason:str)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_stop_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">def</span> <span class="nf">on_prompt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A decorator for a handler method for the PROMPT event (text-to-speech is streaming in).</span>

<span class="sd">        async def prompt_handler(workflow:relay.workflow.Workflow, source_uri:str, prompt_type:str)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_prompt_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">def</span> <span class="nf">on_button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">button</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">taps</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A decorator for a handler method for the BUTTON event (the Talk button was pressed).</span>

<span class="sd">        async def button_handler(workflow:relay.workflow.Workflow, button:str, taps:str, source_uri:str)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">on_button_decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_button_event&#39;</span><span class="p">,</span> <span class="n">button</span><span class="p">,</span> <span class="n">taps</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>

        <span class="k">if</span> <span class="n">_func</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">on_button_decorator</span><span class="p">(</span><span class="n">_func</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">on_button_decorator</span>

    <span class="k">def</span> <span class="nf">on_notification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A decorator for a handler method for the NOTIFICATION event (a broadcast or alert was sent).</span>

<span class="sd">        async def button_handler(workflow:relay.workflow.Workflow, button:str, taps:str, source_uri:str)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">on_notification_decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_notification_event&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">event</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>

        <span class="k">if</span> <span class="n">_func</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">on_notification_decorator</span><span class="p">(</span><span class="n">_func</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">on_notification_decorator</span>

    <span class="k">def</span> <span class="nf">on_timer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="c1"># unnamed timer</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A decorator for a handler method for the TIMER event (the unnamed timer fired).</span>

<span class="sd">        async def timer_handler(workflow:relay.workflow.Workflow)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_timer_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">def</span> <span class="nf">on_timer_fired</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="c1"># named timer</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A decorator for a handler method for the TIMER_FIRED event (a named timer fired).</span>

<span class="sd">        async def timer_fired_handler(workflow:relay.workflow.Workflow, timer_name:str)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_timer_fired_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">def</span> <span class="nf">on_speech</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A decorator for a handler method for the SPEECH event (the listen() function is running).</span>

<span class="sd">        async def speech_handler(workflow:relay.workflow.Workflow, transcribed_text:str, audio:bytes, language:str,</span>
<span class="sd">                                 request_id:str, source_uri:str)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_speech_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">def</span> <span class="nf">on_progress</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A decorator for a handler method for the PROGRESS event (a long running action is being</span>
<span class="sd">        performed across a large number of devices, may get called multiple times).</span>

<span class="sd">        async def progress_handler(workflow:relay.workflow.Workflow)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_progress_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">def</span> <span class="nf">on_play_inbox_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A decorator for a handler method for the PLAY_INBOX_MESSAGE event (a missed message</span>
<span class="sd">        is being played).</span>

<span class="sd">        async def play_inbox_message_handler(workflow:relay.workflow.Workflow, action:str)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_play_inbox_message_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">def</span> <span class="nf">on_call_connected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A decorator for a handler method for the CALL_CONNECTED event.</span>
<span class="sd">        A call attempt that was ringing, progressing, or incoming is now fully</span>
<span class="sd">        connected. This event can occur on both the caller and the callee.</span>

<span class="sd">        async def call_connected_handler(workflow:relay.workflow.Workflow, call_id:str, direction:str,</span>
<span class="sd">                                         other_device_id:str, other_device_name:str,</span>
<span class="sd">                                         uri:str, onnet:bool,</span>
<span class="sd">                                         start_time_epoch:int, connect_time_epoch:int)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_call_connected_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">def</span> <span class="nf">on_call_disconnected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A decorator for a handler method for the CALL_DISCONNECTED event.</span>
<span class="sd">        A call that was once connected has become disconnected. This event can</span>
<span class="sd">        occur on both the caller and the callee.</span>

<span class="sd">        async def call_disconnected_handler(workflow:relay.workflow.Workflow, call_id:str, direction:str,</span>
<span class="sd">                                            other_device_id:str, other_device_name:str,</span>
<span class="sd">                                            uri:str, onnet:bool, reason:str,</span>
<span class="sd">                                            start_time_epoch:int, connect_time_epoch:int, end_time_epoch:int)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_call_disconnected_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">def</span> <span class="nf">on_call_failed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A decorator for a handler method for the CALL_FAILED event.</span>
<span class="sd">        A call failed to get connected. This event can occur on both the caller</span>
<span class="sd">        and the callee.</span>

<span class="sd">        async def call_failed_handler(workflow:relay.workflow.Workflow, call_id:str, direction:str,</span>
<span class="sd">                                      other_device_id:str, other_device_name:str,</span>
<span class="sd">                                      uri:str, onnet:bool, reason:str,</span>
<span class="sd">                                      start_time_epoch:int, connect_time_epoch:int, end_time_epoch:int)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_call_failed_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">def</span> <span class="nf">on_call_received</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A decorator for a handler method for the CALL_RECEIVED event.</span>
<span class="sd">        The device is receiving an inbound call request. This event can occur</span>
<span class="sd">        on the callee.</span>

<span class="sd">        async def call_received_handler(workflow:relay.workflow.Workflow, call_id:str, direction:str,</span>
<span class="sd">                                        other_device_id:str, other_device_name:str,</span>
<span class="sd">                                        uri:str, onnet:bool,</span>
<span class="sd">                                        start_time_epoch:int)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_call_received_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">def</span> <span class="nf">on_call_ringing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A decorator for a handler method for the CALL_RINGING event.</span>
<span class="sd">        The device we called is ringing. We are waiting for them to answer.</span>
<span class="sd">        This event can occur on the caller.</span>

<span class="sd">        async def call_ringing_handler(workflow:relay.workflow.Workflow, call_id:str, direction:str,</span>
<span class="sd">                                       other_device_id:str, other_device_name:str,</span>
<span class="sd">                                       uri:str, onnet:bool,</span>
<span class="sd">                                       start_time_epoch:int)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_call_ringing_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">def</span> <span class="nf">on_call_start_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A decorator for a handler method for the CALL_START_REQUEST event.</span>
<span class="sd">        There is a request to make an outbound call. This event can occur on</span>
<span class="sd">        the caller after using the &quot;Call X&quot; voice command on the Assistant.</span>

<span class="sd">        async def call_start_request_handler(workflow:relay.workflow.Workflow, destination_uri:str)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_call_start_request_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">def</span> <span class="nf">on_call_progressing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A decorator for a handler method for the CALL_PROGRESSING event.</span>
<span class="sd">        The device we called is making progress on getting connected. This may</span>
<span class="sd">        be interspersed with on_call_ringing. This event can occur on the caller.</span>

<span class="sd">        async def call_progressing_handler(workflow:relay.workflow.Workflow, call_id:str, direction:str,</span>
<span class="sd">                                           other_device_id:str, other_device_name:str,</span>
<span class="sd">                                           uri:str, onnet:bool,</span>
<span class="sd">                                           start_time_epoch:int, connect_time_epoch:int)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_call_progressing_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">def</span> <span class="nf">on_sms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A decorator for a handler method for the SMS event (TBD).</span>

<span class="sd">        async def sms_handler(workflow:relay.workflow.Workflow, id:str, event:dict)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_sms_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">def</span> <span class="nf">on_incident</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A decorator for a handler method for the INCIDENT event (an incident has been created).</span>

<span class="sd">        async def incident_handler(workflow:relay.workflow.Workflow, type:str, incident_id:str, reason:str)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_incident_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">def</span> <span class="nf">on_interaction_lifecycle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A decorator for a handler method for the INTERACTION_LIFECYCLE event (an interaction</span>
<span class="sd">        is starting, resuming, or ending).</span>

<span class="sd">        async def interaction_lifecycle_handler(workflow:relay.workflow.Workflow, itype:str, source_uri:str, reason:str)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_interaction_lifecycle_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">def</span> <span class="nf">on_resume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A decorator for a handler method for the RESUME event (TBD).</span>

<span class="sd">        async def resume_handler(workflow:relay.workflow.Workflow, trigger:dict)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_resume_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">def</span> <span class="nf">get_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">event</span><span class="p">[</span><span class="s1">&#39;_type&#39;</span><span class="p">]</span>

        <span class="c1"># Assume no-arg handler; if not, check the handlers that require args.</span>
        <span class="c1"># For args, check for handler registered with specific values first; if not,</span>
        <span class="c1"># then check variations with wildcard values.</span>
        <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">h</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;wf_api_button_event&#39;</span><span class="p">:</span>
                <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="n">t</span><span class="p">,</span> <span class="n">event</span><span class="p">[</span><span class="s1">&#39;button&#39;</span><span class="p">],</span> <span class="n">event</span><span class="p">[</span><span class="s1">&#39;taps&#39;</span><span class="p">]),</span> <span class="kc">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">h</span><span class="p">:</span>
                    <span class="c1"># prefer button match over taps</span>
                    <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="n">t</span><span class="p">,</span> <span class="n">event</span><span class="p">[</span><span class="s1">&#39;button&#39;</span><span class="p">],</span> <span class="s1">&#39;*&#39;</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">h</span><span class="p">:</span>
                        <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="n">t</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">event</span><span class="p">[</span><span class="s1">&#39;taps&#39;</span><span class="p">]),</span> <span class="kc">None</span><span class="p">)</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">h</span><span class="p">:</span>
                            <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="n">t</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;wf_api_notification_event&#39;</span><span class="p">:</span>
                <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="n">t</span><span class="p">,</span> <span class="n">event</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">event</span><span class="p">[</span><span class="s1">&#39;event&#39;</span><span class="p">]),</span> <span class="kc">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">h</span><span class="p">:</span>
                    <span class="c1"># prefer name match over event</span>
                    <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="n">t</span><span class="p">,</span> <span class="n">event</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="s1">&#39;*&#39;</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">h</span><span class="p">:</span>
                        <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="n">t</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">event</span><span class="p">[</span><span class="s1">&#39;event&#39;</span><span class="p">]),</span> <span class="kc">None</span><span class="p">)</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">h</span><span class="p">:</span>
                            <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="n">t</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">h</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Workflow.on_button" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">on_button</span><span class="p">(</span><span class="n">_func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">button</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">taps</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>A decorator for a handler method for the BUTTON event (the Talk button was pressed).</p>
<p>async def button_handler(workflow:relay.workflow.Workflow, button:str, taps:str, source_uri:str)</p>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">on_button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">button</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">taps</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A decorator for a handler method for the BUTTON event (the Talk button was pressed).</span>

<span class="sd">    async def button_handler(workflow:relay.workflow.Workflow, button:str, taps:str, source_uri:str)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">on_button_decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_button_event&#39;</span><span class="p">,</span> <span class="n">button</span><span class="p">,</span> <span class="n">taps</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">if</span> <span class="n">_func</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">on_button_decorator</span><span class="p">(</span><span class="n">_func</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">on_button_decorator</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Workflow.on_call_connected" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">on_call_connected</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>A decorator for a handler method for the CALL_CONNECTED event.
A call attempt that was ringing, progressing, or incoming is now fully
connected. This event can occur on both the caller and the callee.</p>
<p>async def call_connected_handler(workflow:relay.workflow.Workflow, call_id:str, direction:str,
                                 other_device_id:str, other_device_name:str,
                                 uri:str, onnet:bool,
                                 start_time_epoch:int, connect_time_epoch:int)</p>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">on_call_connected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A decorator for a handler method for the CALL_CONNECTED event.</span>
<span class="sd">    A call attempt that was ringing, progressing, or incoming is now fully</span>
<span class="sd">    connected. This event can occur on both the caller and the callee.</span>

<span class="sd">    async def call_connected_handler(workflow:relay.workflow.Workflow, call_id:str, direction:str,</span>
<span class="sd">                                     other_device_id:str, other_device_name:str,</span>
<span class="sd">                                     uri:str, onnet:bool,</span>
<span class="sd">                                     start_time_epoch:int, connect_time_epoch:int)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_call_connected_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Workflow.on_call_disconnected" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">on_call_disconnected</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>A decorator for a handler method for the CALL_DISCONNECTED event.
A call that was once connected has become disconnected. This event can
occur on both the caller and the callee.</p>
<p>async def call_disconnected_handler(workflow:relay.workflow.Workflow, call_id:str, direction:str,
                                    other_device_id:str, other_device_name:str,
                                    uri:str, onnet:bool, reason:str,
                                    start_time_epoch:int, connect_time_epoch:int, end_time_epoch:int)</p>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">on_call_disconnected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A decorator for a handler method for the CALL_DISCONNECTED event.</span>
<span class="sd">    A call that was once connected has become disconnected. This event can</span>
<span class="sd">    occur on both the caller and the callee.</span>

<span class="sd">    async def call_disconnected_handler(workflow:relay.workflow.Workflow, call_id:str, direction:str,</span>
<span class="sd">                                        other_device_id:str, other_device_name:str,</span>
<span class="sd">                                        uri:str, onnet:bool, reason:str,</span>
<span class="sd">                                        start_time_epoch:int, connect_time_epoch:int, end_time_epoch:int)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_call_disconnected_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Workflow.on_call_failed" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">on_call_failed</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>A decorator for a handler method for the CALL_FAILED event.
A call failed to get connected. This event can occur on both the caller
and the callee.</p>
<p>async def call_failed_handler(workflow:relay.workflow.Workflow, call_id:str, direction:str,
                              other_device_id:str, other_device_name:str,
                              uri:str, onnet:bool, reason:str,
                              start_time_epoch:int, connect_time_epoch:int, end_time_epoch:int)</p>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">on_call_failed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A decorator for a handler method for the CALL_FAILED event.</span>
<span class="sd">    A call failed to get connected. This event can occur on both the caller</span>
<span class="sd">    and the callee.</span>

<span class="sd">    async def call_failed_handler(workflow:relay.workflow.Workflow, call_id:str, direction:str,</span>
<span class="sd">                                  other_device_id:str, other_device_name:str,</span>
<span class="sd">                                  uri:str, onnet:bool, reason:str,</span>
<span class="sd">                                  start_time_epoch:int, connect_time_epoch:int, end_time_epoch:int)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_call_failed_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Workflow.on_call_progressing" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">on_call_progressing</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>A decorator for a handler method for the CALL_PROGRESSING event.
The device we called is making progress on getting connected. This may
be interspersed with on_call_ringing. This event can occur on the caller.</p>
<p>async def call_progressing_handler(workflow:relay.workflow.Workflow, call_id:str, direction:str,
                                   other_device_id:str, other_device_name:str,
                                   uri:str, onnet:bool,
                                   start_time_epoch:int, connect_time_epoch:int)</p>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">on_call_progressing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A decorator for a handler method for the CALL_PROGRESSING event.</span>
<span class="sd">    The device we called is making progress on getting connected. This may</span>
<span class="sd">    be interspersed with on_call_ringing. This event can occur on the caller.</span>

<span class="sd">    async def call_progressing_handler(workflow:relay.workflow.Workflow, call_id:str, direction:str,</span>
<span class="sd">                                       other_device_id:str, other_device_name:str,</span>
<span class="sd">                                       uri:str, onnet:bool,</span>
<span class="sd">                                       start_time_epoch:int, connect_time_epoch:int)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_call_progressing_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Workflow.on_call_received" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">on_call_received</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>A decorator for a handler method for the CALL_RECEIVED event.
The device is receiving an inbound call request. This event can occur
on the callee.</p>
<p>async def call_received_handler(workflow:relay.workflow.Workflow, call_id:str, direction:str,
                                other_device_id:str, other_device_name:str,
                                uri:str, onnet:bool,
                                start_time_epoch:int)</p>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">on_call_received</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A decorator for a handler method for the CALL_RECEIVED event.</span>
<span class="sd">    The device is receiving an inbound call request. This event can occur</span>
<span class="sd">    on the callee.</span>

<span class="sd">    async def call_received_handler(workflow:relay.workflow.Workflow, call_id:str, direction:str,</span>
<span class="sd">                                    other_device_id:str, other_device_name:str,</span>
<span class="sd">                                    uri:str, onnet:bool,</span>
<span class="sd">                                    start_time_epoch:int)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_call_received_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Workflow.on_call_ringing" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">on_call_ringing</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>A decorator for a handler method for the CALL_RINGING event.
The device we called is ringing. We are waiting for them to answer.
This event can occur on the caller.</p>
<p>async def call_ringing_handler(workflow:relay.workflow.Workflow, call_id:str, direction:str,
                               other_device_id:str, other_device_name:str,
                               uri:str, onnet:bool,
                               start_time_epoch:int)</p>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">on_call_ringing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A decorator for a handler method for the CALL_RINGING event.</span>
<span class="sd">    The device we called is ringing. We are waiting for them to answer.</span>
<span class="sd">    This event can occur on the caller.</span>

<span class="sd">    async def call_ringing_handler(workflow:relay.workflow.Workflow, call_id:str, direction:str,</span>
<span class="sd">                                   other_device_id:str, other_device_name:str,</span>
<span class="sd">                                   uri:str, onnet:bool,</span>
<span class="sd">                                   start_time_epoch:int)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_call_ringing_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Workflow.on_call_start_request" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">on_call_start_request</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>A decorator for a handler method for the CALL_START_REQUEST event.
There is a request to make an outbound call. This event can occur on
the caller after using the "Call X" voice command on the Assistant.</p>
<p>async def call_start_request_handler(workflow:relay.workflow.Workflow, destination_uri:str)</p>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">on_call_start_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A decorator for a handler method for the CALL_START_REQUEST event.</span>
<span class="sd">    There is a request to make an outbound call. This event can occur on</span>
<span class="sd">    the caller after using the &quot;Call X&quot; voice command on the Assistant.</span>

<span class="sd">    async def call_start_request_handler(workflow:relay.workflow.Workflow, destination_uri:str)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_call_start_request_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Workflow.on_incident" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">on_incident</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>A decorator for a handler method for the INCIDENT event (an incident has been created).</p>
<p>async def incident_handler(workflow:relay.workflow.Workflow, type:str, incident_id:str, reason:str)</p>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">on_incident</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A decorator for a handler method for the INCIDENT event (an incident has been created).</span>

<span class="sd">    async def incident_handler(workflow:relay.workflow.Workflow, type:str, incident_id:str, reason:str)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_incident_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Workflow.on_interaction_lifecycle" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">on_interaction_lifecycle</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>A decorator for a handler method for the INTERACTION_LIFECYCLE event (an interaction
is starting, resuming, or ending).</p>
<p>async def interaction_lifecycle_handler(workflow:relay.workflow.Workflow, itype:str, source_uri:str, reason:str)</p>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">on_interaction_lifecycle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A decorator for a handler method for the INTERACTION_LIFECYCLE event (an interaction</span>
<span class="sd">    is starting, resuming, or ending).</span>

<span class="sd">    async def interaction_lifecycle_handler(workflow:relay.workflow.Workflow, itype:str, source_uri:str, reason:str)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_interaction_lifecycle_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Workflow.on_notification" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">on_notification</span><span class="p">(</span><span class="n">_func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>A decorator for a handler method for the NOTIFICATION event (a broadcast or alert was sent).</p>
<p>async def button_handler(workflow:relay.workflow.Workflow, button:str, taps:str, source_uri:str)</p>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">on_notification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A decorator for a handler method for the NOTIFICATION event (a broadcast or alert was sent).</span>

<span class="sd">    async def button_handler(workflow:relay.workflow.Workflow, button:str, taps:str, source_uri:str)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">on_notification_decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_notification_event&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">event</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">if</span> <span class="n">_func</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">on_notification_decorator</span><span class="p">(</span><span class="n">_func</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">on_notification_decorator</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Workflow.on_play_inbox_message" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">on_play_inbox_message</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>A decorator for a handler method for the PLAY_INBOX_MESSAGE event (a missed message
is being played).</p>
<p>async def play_inbox_message_handler(workflow:relay.workflow.Workflow, action:str)</p>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">on_play_inbox_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A decorator for a handler method for the PLAY_INBOX_MESSAGE event (a missed message</span>
<span class="sd">    is being played).</span>

<span class="sd">    async def play_inbox_message_handler(workflow:relay.workflow.Workflow, action:str)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_play_inbox_message_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Workflow.on_progress" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">on_progress</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>A decorator for a handler method for the PROGRESS event (a long running action is being
performed across a large number of devices, may get called multiple times).</p>
<p>async def progress_handler(workflow:relay.workflow.Workflow)</p>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">on_progress</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A decorator for a handler method for the PROGRESS event (a long running action is being</span>
<span class="sd">    performed across a large number of devices, may get called multiple times).</span>

<span class="sd">    async def progress_handler(workflow:relay.workflow.Workflow)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_progress_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Workflow.on_prompt" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">on_prompt</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>A decorator for a handler method for the PROMPT event (text-to-speech is streaming in).</p>
<p>async def prompt_handler(workflow:relay.workflow.Workflow, source_uri:str, prompt_type:str)</p>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">on_prompt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A decorator for a handler method for the PROMPT event (text-to-speech is streaming in).</span>

<span class="sd">    async def prompt_handler(workflow:relay.workflow.Workflow, source_uri:str, prompt_type:str)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_prompt_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Workflow.on_resume" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">on_resume</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>A decorator for a handler method for the RESUME event (TBD).</p>
<p>async def resume_handler(workflow:relay.workflow.Workflow, trigger:dict)</p>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">on_resume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A decorator for a handler method for the RESUME event (TBD).</span>

<span class="sd">    async def resume_handler(workflow:relay.workflow.Workflow, trigger:dict)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_resume_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Workflow.on_sms" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">on_sms</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>A decorator for a handler method for the SMS event (TBD).</p>
<p>async def sms_handler(workflow:relay.workflow.Workflow, id:str, event:dict)</p>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">on_sms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A decorator for a handler method for the SMS event (TBD).</span>

<span class="sd">    async def sms_handler(workflow:relay.workflow.Workflow, id:str, event:dict)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_sms_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Workflow.on_speech" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">on_speech</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>A decorator for a handler method for the SPEECH event (the listen() function is running).</p>
<p>async def speech_handler(workflow:relay.workflow.Workflow, transcribed_text:str, audio:bytes, language:str,
                         request_id:str, source_uri:str)</p>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">on_speech</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A decorator for a handler method for the SPEECH event (the listen() function is running).</span>

<span class="sd">    async def speech_handler(workflow:relay.workflow.Workflow, transcribed_text:str, audio:bytes, language:str,</span>
<span class="sd">                             request_id:str, source_uri:str)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_speech_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Workflow.on_start" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">on_start</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>A decorator for a handler method for the START event (workflow is starting).</p>
<p>async def start_handler(workflow:relay.workflow.Workflow, trigger:dict)</p>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">on_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A decorator for a handler method for the START event (workflow is starting).</span>

<span class="sd">    async def start_handler(workflow:relay.workflow.Workflow, trigger:dict)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_start_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Workflow.on_stop" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">on_stop</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>A decorator for a handler method for the STOP event (workflow is stopping).</p>
<p>async def stop_handler(workflow:relay.workflow.Workflow, reason:str)</p>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">on_stop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A decorator for a handler method for the STOP event (workflow is stopping).</span>

<span class="sd">    async def stop_handler(workflow:relay.workflow.Workflow, reason:str)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_stop_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Workflow.on_timer" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">on_timer</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>A decorator for a handler method for the TIMER event (the unnamed timer fired).</p>
<p>async def timer_handler(workflow:relay.workflow.Workflow)</p>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">on_timer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
    <span class="c1"># unnamed timer</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A decorator for a handler method for the TIMER event (the unnamed timer fired).</span>

<span class="sd">    async def timer_handler(workflow:relay.workflow.Workflow)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_timer_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="relay.workflow.Workflow.on_timer_fired" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">on_timer_fired</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>A decorator for a handler method for the TIMER_FIRED event (a named timer fired).</p>
<p>async def timer_fired_handler(workflow:relay.workflow.Workflow, timer_name:str)</p>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">on_timer_fired</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
    <span class="c1"># named timer</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A decorator for a handler method for the TIMER_FIRED event (a named timer fired).</span>

<span class="sd">    async def timer_fired_handler(workflow:relay.workflow.Workflow, timer_name:str)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">type_handlers</span><span class="p">[</span><span class="s1">&#39;wf_api_timer_fired_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>



<div class="doc doc-object doc-function">




<h2 id="relay.workflow.device_id" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">device_id</span><span class="p">(</span><span class="n">gid</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Creates a URN from a device ID.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>gid</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the ID of the device.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the newly constructed URN.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">device_id</span><span class="p">(</span><span class="n">gid</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a URN from a device ID.</span>

<span class="sd">    Args:</span>
<span class="sd">        gid (str): the ID of the device.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: the newly constructed URN.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_construct</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">,</span> <span class="n">ID</span><span class="p">,</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">gid</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="relay.workflow.device_name" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">device_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Creates a URN from a device name.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the name of the device.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the newly constructed URN.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">device_name</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a URN from a device name.</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): the name of the device.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: the newly constructed URN.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_construct</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">,</span> <span class="n">NAME</span><span class="p">,</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="relay.workflow.fetch_device" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">fetch_device</span><span class="p">(</span><span class="n">access_token</span><span class="p">,</span> <span class="n">refresh_token</span><span class="p">,</span> <span class="n">client_id</span><span class="p">,</span> <span class="n">subscriber_id</span><span class="p">,</span> <span class="n">user_id</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>A convenience method for getting all the details of a device.</p>
<p>This will return quite a bit of data regarding device configuration and
state. The result, if the query was successful, should have a large JSON
dictionary.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>access_token(str)</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the current access token. Can be a placeholder value</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>refresh_token(str)</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the permanent refresh_token that can be used to</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>client_id(str)</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the auth_sdk_id as returned from "relay env".</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>subscriber_id(str)</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the subcriber UUID as returned from "relay whoami".</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>user_id(str)</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the IMEI of the target device, such as 990007560023456.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2248</span>
<span class="normal">2249</span>
<span class="normal">2250</span>
<span class="normal">2251</span>
<span class="normal">2252</span>
<span class="normal">2253</span>
<span class="normal">2254</span>
<span class="normal">2255</span>
<span class="normal">2256</span>
<span class="normal">2257</span>
<span class="normal">2258</span>
<span class="normal">2259</span>
<span class="normal">2260</span>
<span class="normal">2261</span>
<span class="normal">2262</span>
<span class="normal">2263</span>
<span class="normal">2264</span>
<span class="normal">2265</span>
<span class="normal">2266</span>
<span class="normal">2267</span>
<span class="normal">2268</span>
<span class="normal">2269</span>
<span class="normal">2270</span>
<span class="normal">2271</span>
<span class="normal">2272</span>
<span class="normal">2273</span>
<span class="normal">2274</span>
<span class="normal">2275</span>
<span class="normal">2276</span>
<span class="normal">2277</span>
<span class="normal">2278</span>
<span class="normal">2279</span>
<span class="normal">2280</span>
<span class="normal">2281</span>
<span class="normal">2282</span>
<span class="normal">2283</span>
<span class="normal">2284</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fetch_device</span><span class="p">(</span><span class="n">access_token</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">refresh_token</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">client_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subscriber_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A convenience method for getting all the details of a device.</span>

<span class="sd">    This will return quite a bit of data regarding device configuration and</span>
<span class="sd">    state. The result, if the query was successful, should have a large JSON</span>
<span class="sd">    dictionary.</span>

<span class="sd">    Args:</span>
<span class="sd">        access_token(str): the current access token. Can be a placeholder value</span>
<span class="sd">        and this method will generate a new one and return it. If the</span>
<span class="sd">        original value of the access token passed in here has expired,</span>
<span class="sd">        this method will also generate a new one and return it.</span>

<span class="sd">        refresh_token(str): the permanent refresh_token that can be used to</span>
<span class="sd">        obtain a new access_token. The caller should treat the refresh</span>
<span class="sd">        token as very sensitive data, and secure it appropriately.</span>

<span class="sd">        client_id(str): the auth_sdk_id as returned from &quot;relay env&quot;.</span>

<span class="sd">        subscriber_id(str): the subcriber UUID as returned from &quot;relay whoami&quot;.</span>

<span class="sd">        user_id(str): the IMEI of the target device, such as 990007560023456.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;https://</span><span class="si">{</span><span class="n">SERVER_HOSTNAME</span><span class="si">}</span><span class="s1">/relaypro/api/v1/device/</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Authorization&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;Bearer </span><span class="si">{</span><span class="n">access_token</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="n">VERSION</span>
    <span class="p">}</span>
    <span class="n">query_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;subscriber_id&#39;</span><span class="p">:</span> <span class="n">subscriber_id</span><span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">query_params</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">401</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;got 401 on get, trying to get new access token&#39;</span><span class="p">)</span>
        <span class="n">access_token</span> <span class="o">=</span> <span class="n">_update_access_token</span><span class="p">(</span><span class="n">refresh_token</span><span class="p">,</span> <span class="n">client_id</span><span class="p">)</span>
        <span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Authorization&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Bearer </span><span class="si">{</span><span class="n">access_token</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">query_params</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;device_info status code=</span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span><span class="p">,</span> <span class="n">access_token</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="relay.workflow.group_id" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">group_id</span><span class="p">(</span><span class="n">gid</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Creates a URN from a group ID.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>gid</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the ID of the group.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the newly constructed URN.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">group_id</span><span class="p">(</span><span class="n">gid</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a URN from a group ID.</span>

<span class="sd">    Args:</span>
<span class="sd">        gid (str): the ID of the group.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: the newly constructed URN.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_construct</span><span class="p">(</span><span class="n">GROUP</span><span class="p">,</span> <span class="n">ID</span><span class="p">,</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">gid</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="relay.workflow.group_member" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">group_member</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Creates a URN for a group member.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>group</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the name of the group that the device belongs to.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>device</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device ID or name.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the newly constructed URN.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">group_member</span><span class="p">(</span><span class="n">group</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">device</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a URN for a group member.</span>

<span class="sd">    Args:</span>
<span class="sd">        group (str): the name of the group that the device belongs to.</span>
<span class="sd">        device (str): the device ID or name.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: the newly constructed URN.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">SCHEME</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">ROOT</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">NAME</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">GROUP</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">group</span><span class="p">)</span><span class="si">}{</span><span class="n">DEVICE_PATTERN</span><span class="si">}</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span>
        <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">SCHEME</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">ROOT</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">NAME</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">DEVICE</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">device</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="relay.workflow.group_name" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">group_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Creates a URN from a group name.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the name of the group.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the newly constructed URN.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">group_name</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a URN from a group name.</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): the name of the group.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: the newly constructed URN.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_construct</span><span class="p">(</span><span class="n">GROUP</span><span class="p">,</span> <span class="n">NAME</span><span class="p">,</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="relay.workflow.interaction_name" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">interaction_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Creates a URN from an interaction name.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the name of the interaction</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the newly constructed URN.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">interaction_name</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a URN from an interaction name.</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): the name of the interaction</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: the newly constructed URN.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_construct</span><span class="p">(</span><span class="n">INTERACTION</span><span class="p">,</span> <span class="n">NAME</span><span class="p">,</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="relay.workflow.is_interaction_uri" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">is_interaction_uri</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Checks if the URN is for an interaction.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>uri</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device URN.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>bool</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>true if the URN is an interaction URN, false otherwise.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_interaction_uri</span><span class="p">(</span><span class="n">uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks if the URN is for an interaction.</span>

<span class="sd">    Args:</span>
<span class="sd">        uri (str): the device URN.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: true if the URN is an interaction URN, false otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">INTERACTION_URI_NAME</span> <span class="ow">in</span> <span class="n">uri</span> <span class="ow">or</span> <span class="n">INTERACTION_URI_ID</span> <span class="ow">in</span> <span class="n">uri</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="relay.workflow.is_relay_uri" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">is_relay_uri</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Checks if the URN is a Relay URN.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>uri</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device, group, or interaction URN.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>bool</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>true if the URN is a Relay URN, false otherwise.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_relay_uri</span><span class="p">(</span><span class="n">uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks if the URN is a Relay URN.</span>

<span class="sd">    Args:</span>
<span class="sd">        uri (str): the device, group, or interaction URN.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: true if the URN is a Relay URN, false otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">uri</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">SCHEME</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">ROOT</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="relay.workflow.parse_device_id" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">parse_device_id</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Parses out a device ID from a device or interaction URN.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>uri</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device or interaction URN that you would like to extract the device ID from.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device ID.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse_device_id</span><span class="p">(</span><span class="n">uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parses out a device ID from a device or interaction URN.</span>

<span class="sd">    Args:</span>
<span class="sd">        uri (str): the device or interaction URN that you would like to extract the device ID from.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: the device ID.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">uri</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_interaction_uri</span><span class="p">(</span><span class="n">uri</span><span class="p">):</span>
        <span class="n">scheme</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">id_type</span><span class="p">,</span> <span class="n">resource_type</span><span class="p">,</span> <span class="n">gid</span> <span class="o">=</span> <span class="n">uri</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">id_type</span> <span class="o">==</span> <span class="n">ID</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">gid</span>
    <span class="k">elif</span> <span class="n">is_interaction_uri</span><span class="p">(</span><span class="n">uri</span><span class="p">):</span>
        <span class="n">scheme</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">id_type</span><span class="p">,</span> <span class="n">resource_type</span><span class="p">,</span> <span class="n">i_id</span><span class="p">,</span> <span class="n">i_root</span><span class="p">,</span> <span class="n">i_id_type</span><span class="p">,</span> <span class="n">i_resource_type</span><span class="p">,</span> <span class="n">gid</span> <span class="o">=</span> <span class="n">uri</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">id_type</span> <span class="o">==</span> <span class="n">ID</span> <span class="ow">and</span> <span class="n">i_id_type</span> <span class="o">==</span> <span class="n">ID</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">gid</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;invalid device urn&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="relay.workflow.parse_device_name" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">parse_device_name</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Parses out a device name from a device or interaction URN.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>uri</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device or interaction URN that you would like to extract the device name from.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device name.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse_device_name</span><span class="p">(</span><span class="n">uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parses out a device name from a device or interaction URN.</span>

<span class="sd">    Args:</span>
<span class="sd">        uri (str): the device or interaction URN that you would like to extract the device name from.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: the device name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">uri</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_interaction_uri</span><span class="p">(</span><span class="n">uri</span><span class="p">):</span>
        <span class="n">scheme</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">id_type</span><span class="p">,</span> <span class="n">resource_type</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">uri</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">id_type</span> <span class="o">==</span> <span class="n">NAME</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">name</span>
    <span class="k">elif</span> <span class="n">is_interaction_uri</span><span class="p">(</span><span class="n">uri</span><span class="p">):</span>
        <span class="n">scheme</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">id_type</span><span class="p">,</span> <span class="n">resource_type</span><span class="p">,</span> <span class="n">i_name</span><span class="p">,</span> <span class="n">i_root</span><span class="p">,</span> <span class="n">i_id_type</span><span class="p">,</span> <span class="n">i_resource_type</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">uri</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">id_type</span> <span class="o">==</span> <span class="n">NAME</span> <span class="ow">and</span> <span class="n">i_id_type</span> <span class="o">==</span> <span class="n">NAME</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">name</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;invalid device urn&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="relay.workflow.parse_group_id" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">parse_group_id</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Parses out a group ID from a group URN. </p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>uri</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the URN that you would like to extract the group ID from.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the group ID.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse_group_id</span><span class="p">(</span><span class="n">uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parses out a group ID from a group URN. </span>

<span class="sd">    Args:</span>
<span class="sd">        uri (str): the URN that you would like to extract the group ID from.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: the group ID.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">scheme</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">id_type</span><span class="p">,</span> <span class="n">resource_type</span><span class="p">,</span> <span class="n">gid</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">id_type</span> <span class="o">==</span> <span class="n">ID</span> <span class="ow">and</span> <span class="n">resource_type</span> <span class="o">==</span> <span class="n">GROUP</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">gid</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;invalid group urn&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="relay.workflow.parse_group_name" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">parse_group_name</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Parses out a group name from a group URN.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>uri</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the URN that you would like to extract the group name from.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the group name.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse_group_name</span><span class="p">(</span><span class="n">uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parses out a group name from a group URN.</span>

<span class="sd">    Args:</span>
<span class="sd">        uri (str): the URN that you would like to extract the group name from.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: the group name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">scheme</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">id_type</span><span class="p">,</span> <span class="n">resource_type</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">id_type</span> <span class="o">==</span> <span class="n">NAME</span> <span class="ow">and</span> <span class="n">resource_type</span> <span class="o">==</span> <span class="n">GROUP</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">name</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;invalid group urn&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="relay.workflow.parse_interaction" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">parse_interaction</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Parses out the name of an interaction from an interaction URN.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>uri</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the interaction URN that you would like to parse the interaction from.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the name of an interaction.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse_interaction</span><span class="p">(</span><span class="n">uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parses out the name of an interaction from an interaction URN.</span>

<span class="sd">    Args:</span>
<span class="sd">        uri (str): the interaction URN that you would like to parse the interaction from.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: the name of an interaction.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">uri</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">is_interaction_uri</span><span class="p">(</span><span class="n">uri</span><span class="p">):</span>
        <span class="n">scheme</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">id_type</span><span class="p">,</span> <span class="n">resource_type</span><span class="p">,</span> <span class="n">i_name</span><span class="p">,</span> <span class="n">i_root</span><span class="p">,</span> <span class="n">i_id_type</span><span class="p">,</span> <span class="n">i_resource_type</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">uri</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">interaction_name</span><span class="p">,</span> <span class="n">discard</span> <span class="o">=</span> <span class="n">i_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">interaction_name</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;not an interaction urn&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="relay.workflow.trigger_workflow" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">trigger_workflow</span><span class="p">(</span><span class="n">access_token</span><span class="p">,</span> <span class="n">refresh_token</span><span class="p">,</span> <span class="n">client_id</span><span class="p">,</span> <span class="n">workflow_id</span><span class="p">,</span> <span class="n">subscriber_id</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">action_args</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>A convenience method for sending an HTTP trigger to the Relay server.</p>
<p>This generally would be used in a third-party system to start a Relay
workflow via an HTTP trigger and optionally pass data to it with
action_args.  Under the covers, this uses Python's "request" library
for using the https protocol.</p>
<p>If the access_token has expired and the request gets a 401 response,
a new access_token will be automatically generated via the refresh_token,
and the request will be resubmitted with the new access_token. Otherwise
the refresh token won't be used.</p>
<p>This method will return a tuple of (requests.Response, access_token)
where you can inspect the http response, and get the updated access_token
if it was updated (otherwise the original access_token will be returned).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>access_token(str)</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the current access token. Can be a placeholder value</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>refresh_token(str)</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the permanent refresh_token that can be used to</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>client_id(str)</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the auth_sdk_id as returned from "relay env".</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>workflow_id(str)</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the workflow_id as returned from "relay workflow list".</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>subscriber_id(str)</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the subcriber UUID as returned from "relay whoami".</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>user_id(str)</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the IMEI of the target device, such as 990007560023456.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>targets</code></td>
          <td>
                <code><span title="typing.List">List</span>[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the device targets that the workflow should be considered as</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>action_args</code></td>
          <td>
                <code>optional</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>a dict of any key/value arguments you want</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>relay/workflow.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2179</span>
<span class="normal">2180</span>
<span class="normal">2181</span>
<span class="normal">2182</span>
<span class="normal">2183</span>
<span class="normal">2184</span>
<span class="normal">2185</span>
<span class="normal">2186</span>
<span class="normal">2187</span>
<span class="normal">2188</span>
<span class="normal">2189</span>
<span class="normal">2190</span>
<span class="normal">2191</span>
<span class="normal">2192</span>
<span class="normal">2193</span>
<span class="normal">2194</span>
<span class="normal">2195</span>
<span class="normal">2196</span>
<span class="normal">2197</span>
<span class="normal">2198</span>
<span class="normal">2199</span>
<span class="normal">2200</span>
<span class="normal">2201</span>
<span class="normal">2202</span>
<span class="normal">2203</span>
<span class="normal">2204</span>
<span class="normal">2205</span>
<span class="normal">2206</span>
<span class="normal">2207</span>
<span class="normal">2208</span>
<span class="normal">2209</span>
<span class="normal">2210</span>
<span class="normal">2211</span>
<span class="normal">2212</span>
<span class="normal">2213</span>
<span class="normal">2214</span>
<span class="normal">2215</span>
<span class="normal">2216</span>
<span class="normal">2217</span>
<span class="normal">2218</span>
<span class="normal">2219</span>
<span class="normal">2220</span>
<span class="normal">2221</span>
<span class="normal">2222</span>
<span class="normal">2223</span>
<span class="normal">2224</span>
<span class="normal">2225</span>
<span class="normal">2226</span>
<span class="normal">2227</span>
<span class="normal">2228</span>
<span class="normal">2229</span>
<span class="normal">2230</span>
<span class="normal">2231</span>
<span class="normal">2232</span>
<span class="normal">2233</span>
<span class="normal">2234</span>
<span class="normal">2235</span>
<span class="normal">2236</span>
<span class="normal">2237</span>
<span class="normal">2238</span>
<span class="normal">2239</span>
<span class="normal">2240</span>
<span class="normal">2241</span>
<span class="normal">2242</span>
<span class="normal">2243</span>
<span class="normal">2244</span>
<span class="normal">2245</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">trigger_workflow</span><span class="p">(</span><span class="n">access_token</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">refresh_token</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">client_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">workflow_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subscriber_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                     <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">targets</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">action_args</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A convenience method for sending an HTTP trigger to the Relay server.</span>

<span class="sd">    This generally would be used in a third-party system to start a Relay</span>
<span class="sd">    workflow via an HTTP trigger and optionally pass data to it with</span>
<span class="sd">    action_args.  Under the covers, this uses Python&#39;s &quot;request&quot; library</span>
<span class="sd">    for using the https protocol.</span>

<span class="sd">    If the access_token has expired and the request gets a 401 response,</span>
<span class="sd">    a new access_token will be automatically generated via the refresh_token,</span>
<span class="sd">    and the request will be resubmitted with the new access_token. Otherwise</span>
<span class="sd">    the refresh token won&#39;t be used.</span>

<span class="sd">    This method will return a tuple of (requests.Response, access_token)</span>
<span class="sd">    where you can inspect the http response, and get the updated access_token</span>
<span class="sd">    if it was updated (otherwise the original access_token will be returned).</span>

<span class="sd">    Args:</span>
<span class="sd">        access_token(str): the current access token. Can be a placeholder value</span>
<span class="sd">        and this method will generate a new one and return it. If the</span>
<span class="sd">        original value of the access token passed in here has expired,</span>
<span class="sd">        this method will also generate a new one and return it.</span>

<span class="sd">        refresh_token(str): the permanent refresh_token that can be used to</span>
<span class="sd">        obtain a new access_token. The caller should treat the refresh</span>
<span class="sd">        token as very sensitive data, and secure it appropriately.</span>

<span class="sd">        client_id(str): the auth_sdk_id as returned from &quot;relay env&quot;.</span>

<span class="sd">        workflow_id(str): the workflow_id as returned from &quot;relay workflow list&quot;.</span>
<span class="sd">        Usually starts with &quot;wf_&quot;.</span>

<span class="sd">        subscriber_id(str): the subcriber UUID as returned from &quot;relay whoami&quot;.</span>

<span class="sd">        user_id(str): the IMEI of the target device, such as 990007560023456.</span>

<span class="sd">        targets: the device targets that the workflow should be considered as</span>
<span class="sd">        having been triggered from.</span>

<span class="sd">        action_args (optional): a dict of any key/value arguments you want</span>
<span class="sd">        to pass in to the workflow that gets started by this trigger.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;https://</span><span class="si">{</span><span class="n">SERVER_HOSTNAME</span><span class="si">}</span><span class="s1">/ibot/workflow/</span><span class="si">{</span><span class="n">workflow_id</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Authorization&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;Bearer </span><span class="si">{</span><span class="n">access_token</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="n">VERSION</span>
    <span class="p">}</span>
    <span class="n">query_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;subscriber_id&#39;</span><span class="p">:</span> <span class="n">subscriber_id</span><span class="p">,</span>
        <span class="s1">&#39;user_id&#39;</span><span class="p">:</span> <span class="n">user_id</span>
    <span class="p">}</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;invoke&quot;</span><span class="p">}</span>
    <span class="k">if</span> <span class="n">action_args</span><span class="p">:</span>
        <span class="n">payload</span><span class="p">[</span><span class="s1">&#39;action_args&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">action_args</span>
    <span class="k">if</span> <span class="n">targets</span><span class="p">:</span>
        <span class="n">payload</span><span class="p">[</span><span class="s1">&#39;target_device_ids&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">targets</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">query_params</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>
    <span class="c1"># check if access token expired, and if so get a new one from the refresh_token, and resubmit</span>
    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">401</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;got 401 on workflow trigger, trying to get new access token&#39;</span><span class="p">)</span>
        <span class="n">access_token</span> <span class="o">=</span> <span class="n">_update_access_token</span><span class="p">(</span><span class="n">refresh_token</span><span class="p">,</span> <span class="n">client_id</span><span class="p">)</span>
        <span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Authorization&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Bearer </span><span class="si">{</span><span class="n">access_token</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">query_params</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;workflow trigger status code=</span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span><span class="p">,</span> <span class="n">access_token</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": ".", "features": [], "search": "assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.dff1b7c8.min.js"></script>
      
    
  </body>
</html>